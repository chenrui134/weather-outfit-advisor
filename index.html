<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travel Outfit Advisor | æ—…è¡Œç©¿æ­åŠ©æ‰‹</title>
    <style>
        /* åŸºç¡€æ ·å¼ */
        body {
            visibility: hidden;
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'SF Pro Icons', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color: #f5f5f7;
            color: #1d1d1f;
            line-height: 1.47059;
            font-weight: 400;
            letter-spacing: -.022em;
            font-size: 15.75px; /* åŸå§‹ 15px å¢åŠ  5% */
        }

        /* å®¹å™¨æ ·å¼è°ƒæ•´ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;  /* å¢åŠ ä¸Šä¸‹å†…è¾¹è· */
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 18px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.04);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        /* è¯­è¨€åˆ‡æ¢æŒ‰é’®ä½ç½®è°ƒæ•´ */
        .language-switch {
            position: absolute;
            top: 20px;
            right: 20px;
            margin: 0;
        }

        .language-btn {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 8px 12px;
            background: #0071e3;
            color: #fff;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14.7px; /* åŸå§‹ 14px å¢åŠ  5% */
            font-weight: 500;
            min-width: 100px;
            justify-content: space-between;
        }

        .language-btn:hover {
            background: #0077ed;
        }

        .language-btn::after {
            content: 'â–¼';
            font-size: 10.5px; /* åŸå§‹ 10px å¢åŠ  5% */
            transition: transform 0.3s ease;
        }

        .language-btn.active::after {
            transform: rotate(180deg);
        }

        .language-list {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 4px;
            background: #fff;
            border-radius: 6px;
            padding: 4px;
            display: none;
            z-index: 1000;
            min-width: 120px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .language-list.show {
            display: block;
        }

        .language-option {
            padding: 8px 12px;
            color: #1d1d1f;
            cursor: pointer;
            border-radius: 4px;
            transition: background-color 0.2s ease;
        }

        .language-option:hover {
            background: #f5f5f7;
        }

        .language-option.selected {
            background: #0071e3;
            color: #fff;
        }

        /* ä¸»æ ‡é¢˜å’Œè¯´æ˜æ–‡å­—æ ·å¼è°ƒæ•´ */
        .app-title {
            font-size: 35.28px;
            font-weight: 600;
            color: #1d1d1f;
            margin: 0 0 16px;  /* è°ƒæ•´åº•éƒ¨é—´è· */
            text-align: center;
            padding-top: 20px;  /* å¢åŠ é¡¶éƒ¨é—´è· */
        }

        .app-subtitle {
            text-align: center;
            color: #1d1d1f;
            margin: 0 0 8px;  /* è°ƒæ•´è¡Œé—´è· */
            font-size: 15.75px;
        }

        .app-instruction {
            text-align: center;
            color: #86868b;
            margin: 0 0 40px;  /* å¢åŠ ä¸ä¸‹æ–¹å†…å®¹çš„é—´è· */
            font-size: 14.7px;
        }

        /* ä¸»å†…å®¹åŒºåŸŸè°ƒæ•´ */
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0;  /* ç§»é™¤å†…è¾¹è· */
            background: white;
            border-radius: 18px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        .main-content {
            padding: 20px;  /* æ·»åŠ å†…è¾¹è· */
        }

        /* å¯¼èˆªåŒºåŸŸ */
        .navigation {
            display: flex;
            flex-direction: row;
            gap: 12px;
            margin-bottom: 20px;
        }

        .nav-section {
            position: relative;
            flex: 1;
        }

        .nav-title {
            font-size: 14.7px; /* åŸå§‹ 14px å¢åŠ  5% */
            font-weight: 500;
            color: #1d1d1f;
            padding: 8px 12px;
            background: #f5f5f7;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            white-space: nowrap;
        }

        .nav-title::after {
            content: 'â–¼';
            font-size: 10.5px; /* åŸå§‹ 10px å¢åŠ  5% */
            color: #86868b;
            transition: transform 0.3s ease;
            margin-left: 6px;
        }

        .nav-title.active::after {
            transform: rotate(180deg);
        }

        .nav-title:hover {
            background: #e5e5e7;
        }

        .nav-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 8px;
            margin-top: 8px;
            z-index: 10;
            display: none;
            max-height: 300px;
            overflow-y: auto;
            min-width: 160px;
        }

        .nav-list.active {
            display: block;
        }

        .nav-item {
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s ease;
            font-size: 14.7px; /* åŸå§‹ 14px å¢åŠ  5% */
            white-space: nowrap;
        }

        .nav-item:hover {
            background: #f5f5f7;
        }

        .nav-item.selected {
            background: #0071e3;
            color: white;
        }

        /* æœç´¢æ¡† */
        .search-box {
            position: relative;
            margin-bottom: 8px;
        }

        .search-box input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d2d2d7;
            border-radius: 6px;
            font-size: 14.7px; /* åŸå§‹ 14px å¢åŠ  5% */
            background: #f5f5f7;
            transition: all 0.3s ease;
        }

        .search-box input:focus {
            outline: none;
            border-color: #0071e3;
            background: white;
        }

        /* å¤©æ°”ä¿¡æ¯ */
        .weather-info {
            background: white;
            border-radius: 18px;
            padding: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            display: flex;
            gap: 24px;
        }

        .current-weather {
            text-align: center;
            flex: 0 0 200px;
            padding: 20px;
            background: #f5f5f7;
            border-radius: 12px;
        }

        .current-temp {
            font-size: 37.8px; /* åŸå§‹ 36px å¢åŠ  5% */
            font-weight: 600;
            color: #1d1d1f;
            margin-bottom: 8px;
        }

        .current-details {
            font-size: 14.7px; /* åŸå§‹ 14px å¢åŠ  5% */
            color: #1d1d1f;
            margin-bottom: 12px;
            line-height: 1.6;
        }

        .last-update {
            font-size: 12.6px; /* åŸå§‹ 12px å¢åŠ  5% */
            color: #86868b;
        }

        /* å¤©æ°”é¢„æŠ¥å¡ç‰‡å®¹å™¨ */
        .forecast-wrapper {
            position: relative;
            flex: 1;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        .forecast-scroll {
            display: flex;
            gap: 12px;
            transition: transform 0.3s ease;
            padding: 0 32px;
            width: calc(175% + 24px); /* è°ƒæ•´ä¸ºå¯ä»¥å®¹çº³7å¼ å¡ç‰‡çš„å®½åº¦ */
        }

        /* å¤©æ°”é¢„æŠ¥å¡ç‰‡ */
        .forecast-card {
            flex: 0 0 calc(14.28% - 10.3px);
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .forecast-card.active {
            background: #0071e3;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 113, 227, 0.2);
        }

        .forecast-weather-data {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            font-size: 0.9rem;
            color: #666;
        }

        .forecast-card.active .forecast-weather-data {
            color: rgba(255, 255, 255, 0.9);
        }

        .weather-icon {
            font-size: 1.4rem;
            margin: 8px 0;
        }

        /* å¯¼èˆªæŒ‰é’® */
        .nav-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 32px;
            height: 100%;
            border: none;
            background: rgba(0, 0, 0, 0.03);
            color: #1d1d1f;
            font-size: 16.8px; /* åŸå§‹ 16px å¢åŠ  5% */
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 2;
            transition: all 0.2s ease;
        }

        .nav-arrow:hover {
            background: rgba(0, 0, 0, 0.08);
        }

        .nav-arrow.prev {
            left: 0;
            border-top-left-radius: 12px;
            border-bottom-left-radius: 12px;
        }

        .nav-arrow.next {
            right: 0;
            border-top-right-radius: 12px;
            border-bottom-right-radius: 12px;
        }

        .nav-arrow.disabled {
            opacity: 0.3;
            cursor: not-allowed;
            background: rgba(0, 0, 0, 0.03);
        }

        .nav-arrow::before {
            content: '';
            width: 10px;
            height: 10px;
            border-style: solid;
            border-width: 2px 2px 0 0;
            display: inline-block;
            position: relative;
            transform: rotate(-135deg);
            transition: transform 0.2s ease;
        }

        .nav-arrow.next::before {
            transform: rotate(45deg);
        }

        .forecast-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        .forecast-date {
            font-size: 12.6px; /* åŸå§‹ 12px å¢åŠ  5% */
            font-weight: 500;
            margin-bottom: 6px;
            color: #86868b;
        }

        .forecast-weather {
            font-size: 21px; /* åŸå§‹ 20px å¢åŠ  5% */
            margin: 6px 0;
        }

        .forecast-temp {
            font-size: 14.7px; /* åŸå§‹ 14px å¢åŠ  5% */
            margin: 6px 0;
            font-weight: 500;
        }

        .forecast-details {
            font-size: 11.55px; /* åŸå§‹ 11px å¢åŠ  5% */
            color: #86868b;
            line-height: 1.4;
        }

        .forecast-card.active .forecast-date,
        .forecast-card.active .forecast-details {
            color: rgba(255, 255, 255, 0.8);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .weather-info {
                flex-direction: column;
            }

            .current-weather {
                flex: none;
                width: 100%;
            }

            .forecast-scroll {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* ç©¿æ­å»ºè®® */
        .outfit-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            margin-top: 2rem;
            padding: 20px;
            gap: 2rem;
        }

        .outfit-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 24px;
            width: 300px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin: 0 12px;
        }

        .outfit-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .outfit-icon {
            font-size: 1.8rem;
            margin-right: 12px;
        }

        .outfit-title {
            font-size: 1.2rem;
            font-weight: 500;
            color: #333;
        }

        .outfit-temp {
            display: flex;
            align-items: center;
            font-size: 1.1rem;
            color: #0071e3;
            margin-bottom: 16px;
        }

        .outfit-temp-icon {
            margin-right: 8px;
        }

        .outfit-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .outfit-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .outfit-item:last-child {
            border-bottom: none;
        }

        .outfit-item-icon {
            margin-right: 12px;
            color: #666;
        }

        /* æ·»åŠ å“åº”å¼å¸ƒå±€ */
        @media (max-width: 1024px) {
            .outfit-container {
                flex-direction: column;
                align-items: center;
            }
            
            .outfit-card {
                width: 90%;
                max-width: 300px;
                margin-bottom: 1rem;
            }
        }

        /* ç¡®ä¿å†…å®¹åœ¨é¡µé¢åº•éƒ¨ */
        .app-container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding-bottom: 2rem;
        }

        .main-content {
            flex: 1;
        }

        /* ç©¿æ­æ¨èå®¹å™¨çš„æ–°æ ·å¼ */
        #outfit-recommendations {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: auto;
            padding: 2rem 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
        }

        /* é”™è¯¯ä¿¡æ¯ */
        .error-message {
            text-align: center;
            padding: 20px;
            background: #fff3f3;
            border-radius: 12px;
            color: #ff3b30;
            font-size: 14.7px; /* åŸå§‹ 14px å¢åŠ  5% */
            margin-top: 20px;
        }

        /* åŠ è½½æŒ‡ç¤ºå™¨ */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #0071e3;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* åŠ¨ç”»æ•ˆæœ */
        .nav-item, .outfit-card, .forecast-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .nav-item:active, .outfit-card:active, .forecast-card:active {
            transform: scale(0.98);
        }

        /* æ—¥æœŸå¯¼èˆªæ ·å¼ */
        .calendar-wrapper {
            background: white;
            border-radius: 12px;
            padding: 16px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            margin-top: 8px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .calendar-title {
            font-size: 16px;
            font-weight: 500;
            color: #1d1d1f;
        }

        .calendar-nav {
            display: flex;
            gap: 8px;
        }

        .calendar-nav button {
            background: none;
            border: none;
            padding: 4px 8px;
            cursor: pointer;
            color: #0071e3;
            border-radius: 6px;
        }

        .calendar-nav button:hover {
            background: #f5f5f7;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            text-align: center;
        }

        .calendar-weekday {
            font-size: 12px;
            color: #86868b;
            padding: 4px;
            font-weight: 500;
        }

        .calendar-day {
            padding: 8px;
            border-radius: 6px;
            cursor: pointer;
            position: relative;
            font-size: 14px;
        }

        .calendar-day:hover {
            background: #f5f5f7;
        }

        .calendar-day.active {
            background: #0071e3;
            color: white;
        }

        .calendar-day.today {
            font-weight: 600;
        }

        .calendar-day.has-weather::after {
            content: 'â€¢';
            position: absolute;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
            color: #0071e3;
            font-size: 12px;
        }

        .calendar-day.active.has-weather::after {
            color: white;
        }

        .calendar-day.disabled {
            color: #d2d2d7;
            cursor: not-allowed;
        }

        .outfit-content {
            margin-top: 1rem;
            text-align: left;
        }

        .outfit-content ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .outfit-content li {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .outfit-content li:last-child {
            border-bottom: none;
        }

        .outfit-content i {
            margin-right: 12px;
            color: #0071e3;
        }

        #outfit-recommendations {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            margin-top: 2rem;
            padding: 2rem 0;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
        }

        @media (max-width: 1024px) {
            #outfit-recommendations {
                flex-direction: column;
                align-items: center;
            }

            .outfit-card {
                width: 90%;
                max-width: 300px;
                margin: 1rem 0;
            }
        }

        /* æ·»åŠ ç”¨æˆ·è¯„ä»·åŒºåŸŸçš„æ ·å¼ */
        .testimonials-section {
            background: #1a1a1a;
            color: #fff;
            padding: 80px 20px;
            text-align: center;
        }

        .testimonials-header {
            max-width: 800px;
            margin: 0 auto 60px;
        }

        .testimonials-title {
            font-size: 2.8rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .testimonials-title span {
            color: #fff;
        }

        .testimonials-subtitle {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.6;
        }

        .testimonials-container {
            display: flex;
            gap: 24px;
            overflow-x: auto;
            padding: 20px 40px;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            margin: 0 -40px;
        }

        .testimonial-card {
            flex: 0 0 400px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 32px;
            scroll-snap-align: start;
            transition: all 0.3s ease;
            text-align: left;
            backdrop-filter: blur(10px);
        }

        .testimonial-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
        }

        .testimonial-header {
            display: flex;
            align-items: center;
            margin-bottom: 24px;
        }

        .testimonial-avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            margin-right: 16px;
            background: #fff;
            overflow: hidden;
        }

        .testimonial-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .testimonial-info {
            flex: 1;
        }

        .testimonial-name {
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 4px;
            color: #fff;
        }

        .testimonial-position {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
        }

        .testimonial-stars {
            display: flex;
            gap: 4px;
            color: #ffd700;
            font-size: 1.2rem;
            margin-bottom: 16px;
        }

        .testimonial-content {
            font-size: 1rem;
            line-height: 1.7;
            color: rgba(255, 255, 255, 0.85);
            font-style: italic;
        }

        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        .testimonials-container::-webkit-scrollbar {
            height: 8px;
        }

        .testimonials-container::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }

        .testimonials-container::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
        }

        .testimonials-container::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        @media (max-width: 768px) {
            .testimonials-title {
                font-size: 2.2rem;
            }

            .testimonial-card {
                flex: 0 0 300px;
                padding: 24px;
            }
        }

        /* æ·»åŠ å¯¼èˆªæŒ‰é’®æ ·å¼ */
        .testimonials-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #fff;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
        }

        .testimonials-nav:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .testimonials-nav.prev {
            left: 20px;
        }

        .testimonials-nav.next {
            right: 20px;
        }

        /* é»˜è®¤ç”¨æˆ·å¤´åƒæ ·å¼ */
        .testimonial-avatar {
            background: #2c2c2c;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 24px;
        }

        /* æ·»åŠ æŒ‡ç¤ºå™¨æ ·å¼ */
        .testimonials-indicators {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 32px;
        }

        .indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .indicator.active {
            background: #fff;
            transform: scale(1.2);
        }
    </style>

    <!-- é¢„åŠ è½½å…³é”®èµ„æº -->
    <link rel="preconnect" href="https://api.open-meteo.com">
</head>
<body>
    <!-- æ·»åŠ åŠ è½½æŒ‡ç¤ºå™¨ -->
    <div id="loading-indicator" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); display: none;">
        <div class="spinner"></div>
    </div>

    <div class="container">
        <div class="language-switch">
            <button class="language-btn" onclick="toggleLanguageList()">
                <span class="globe-icon">ğŸŒ</span>
                <span class="current-lang">English</span>
            </button>
            <div class="language-list" id="languageList">
                <div class="language-option selected" onclick="switchLanguage('en')">English</div>
                <div class="language-option" onclick="switchLanguage('zh')">ç®€ä½“ä¸­æ–‡</div>
                <div class="language-option" onclick="switchLanguage('zh-TW')">ç¹é«”ä¸­æ–‡</div>
                <div class="language-option" onclick="switchLanguage('ja')">æ—¥æœ¬èª</div>
                <div class="language-option" onclick="switchLanguage('ko')">í•œêµ­ì–´</div>
                <div class="language-option" onclick="switchLanguage('de')">Deutsch</div>
                <div class="language-option" onclick="switchLanguage('fr')">FranÃ§ais</div>
                <div class="language-option" onclick="switchLanguage('it')">Italiano</div>
                <div class="language-option" onclick="switchLanguage('es')">EspaÃ±ol</div>
                <div class="language-option" onclick="switchLanguage('pt')">PortuguÃªs</div>
                <div class="language-option" onclick="switchLanguage('hi')">à¤¹à¤¿à¤‚à¤¦à¥€</div>
    </div>
        </div>
        <div class="app-container">
            <h1 class="app-title">æœ€å¥½çš„å¤©æ°”ç©¿è¡£æŒ‡å—</h1>
            <p class="app-subtitle">å‡ ç§’å†…å°†ç”Ÿæˆä»¤äººæƒŠå¹çš„AIæ¨èç©¿æ­</p>
            <p class="app-instruction">ç›´æ¥åœ¨ä¸‹æ–¹é€‰æ‹©/è¾“å…¥å›½å®¶ï¼ŒåŸå¸‚ï¼Œæ—¥æœŸ</p>
            
            <div class="main-content">
                <div class="navigation">
                    <div class="nav-section">
                        <div class="nav-title" id="country-title">
                            <span class="nav-text">Select Country</span>
                        </div>
                        <div class="nav-list" id="country-list">
                            <input type="text" class="search-box" placeholder="Search country..." onkeyup="filterList(this, 'country-list')">
                            <div class="nav-items"></div>
                        </div>
                    </div>
                    <div class="nav-section">
                        <div class="nav-title" id="city-title">
                            <span class="nav-text">Select City</span>
                        </div>
                        <div class="nav-list" id="city-list">
                            <input type="text" class="search-box" placeholder="Search city..." onkeyup="filterList(this, 'city-list')">
                            <div class="nav-items"></div>
                        </div>
                    </div>
                    <div class="nav-section">
                        <div class="nav-title" id="date-title">
                            <span class="nav-text">Select Date</span>
                        </div>
                        <div class="nav-list" id="date-list">
                            <div class="nav-items"></div>
                        </div>
                    </div>
                </div>

                <div id="weather-info" class="weather-info">
                    <div id="current-weather" class="current-weather"></div>
                    <div id="forecast-container" class="forecast-wrapper"></div>
                </div>
            </div>

            <div id="outfit-recommendations" class="outfit-container"></div>
        </div>
    </div>

    <style>
        /* éé˜»å¡CSS */
        /* æ·»åŠ ä½ çš„å…¶ä»–CSSæ ·å¼ */
    </style>

    <script>
        // æ€§èƒ½ä¼˜åŒ–é…ç½®
        const PERFORMANCE_CONFIG = {
            CACHE_DURATION: 15 * 60 * 1000, // 15åˆ†é’Ÿç¼“å­˜
            REQUEST_TIMEOUT: 10000, // 10ç§’è¶…æ—¶
            AUTO_REFRESH_INTERVAL: 15 * 60 * 1000, // 15åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°
            MAX_RETRY_ATTEMPTS: 3
        };

        // åˆå§‹åŒ–æ€§èƒ½ç›‘æ§
        const performance = {
            timing: {},
            mark(name) {
                this.timing[name] = Date.now();
            },
            measure(start, end) {
                if (this.timing[start] && this.timing[end]) {
                    return this.timing[end] - this.timing[start];
                }
                return 0;
            }
        };

        // é¡µé¢åŠ è½½ä¼˜åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            performance.mark('domReady');
            
            // ç«‹å³æ˜¾ç¤ºé¡µé¢æ¡†æ¶
            requestAnimationFrame(() => {
                document.body.style.visibility = 'visible';
            });
            
            // å»¶è¿ŸåŠ è½½éå…³é”®èµ„æº
            setTimeout(() => {
                initializeApp();
            }, 0);

            // æ·»åŠ å¯¼èˆªæ ‡é¢˜ç‚¹å‡»äº‹ä»¶
            const titles = document.querySelectorAll('.nav-title');
            titles.forEach(title => {
                title.addEventListener('click', () => {
                    const list = title.parentElement.querySelector('.nav-list');
                    const isActive = list.classList.contains('active');
                    
                    // å…³é—­æ‰€æœ‰å…¶ä»–æ‰“å¼€çš„åˆ—è¡¨
                    document.querySelectorAll('.nav-list').forEach(otherList => {
                        if (otherList !== list) {
                            otherList.classList.remove('active');
                            otherList.parentElement.querySelector('.nav-title').classList.remove('active');
                        }
                    });
                    
                    // åˆ‡æ¢å½“å‰åˆ—è¡¨
                    list.classList.toggle('active');
                    title.classList.toggle('active');
                });
            });

            // ç‚¹å‡»å¤–éƒ¨å…³é—­æ‰€æœ‰ä¸‹æ‹‰åˆ—è¡¨
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.nav-section')) {
                    document.querySelectorAll('.nav-list').forEach(list => {
                        list.classList.remove('active');
                        list.parentElement.querySelector('.nav-title').classList.remove('active');
                    });
                }
            });

            // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–ä¸ºè‹±è¯­
            currentLang = 'en';
            localStorage.setItem('preferred_language', 'en');
            
            // æ›´æ–°ç•Œé¢æ–‡æœ¬
            updateInterfaceText('en');
            
            // æ›´æ–°è¯­è¨€æŒ‰é’®çŠ¶æ€
            const currentLangSpan = document.querySelector('.current-lang');
            if (currentLangSpan) {
                currentLangSpan.textContent = 'English';
            }

            // æ›´æ–°é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.language-option').forEach(option => {
                option.classList.toggle('selected', option.textContent === 'English');
            });

            // æ›´æ–°é¡µé¢æ ‡é¢˜
            document.querySelector('.app-title').textContent = 'ğŸŒ Travel Outfit Advisor';

            // æ›´æ–°å¯¼èˆªæ–‡æœ¬
            document.querySelector('#country-title .nav-text').textContent = 'Select Country';
            document.querySelector('#city-title .nav-text').textContent = 'Select City';
            document.querySelector('#date-title .nav-text').textContent = 'Select Date';

            // æ›´æ–°æœç´¢æ¡†å ä½ç¬¦
            const countrySearch = document.querySelector('#country-list .search-box');
            const citySearch = document.querySelector('#city-list .search-box');
            if (countrySearch) countrySearch.placeholder = 'Search country...';
            if (citySearch) citySearch.placeholder = 'Search city...';

            // æ¸²æŸ“å›½å®¶åˆ—è¡¨
            renderCountryList('en');
        });

        // ä¼˜åŒ–åˆå§‹åŒ–è¿‡ç¨‹
        function initializeApp() {
            performance.mark('appInit');

            // åŠ è½½æœ€è¿‘è®¿é—®çš„åŸå¸‚
            try {
                const recentCities = JSON.parse(localStorage.getItem('recentCities')) || [];
                if (recentCities.length > 0) {
                    const city = recentCities[0];
                    if (city.lat && city.lon) {
                        getWeatherData(city.lat, city.lon, currentLang);
                    }
                }
            } catch (error) {
                console.error('Error loading recent cities:', error);
            }

            performance.mark('appInitEnd');
            console.log('App initialization time:', performance.measure('appInit', 'appInitEnd'), 'ms');
        }

        // ä¼˜åŒ–æ•°æ®è¯·æ±‚
        async function fetchWithRetry(url, options = {}, retryCount = 0) {
            try {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), PERFORMANCE_CONFIG.REQUEST_TIMEOUT);

                const response = await fetch(url, {
                    ...options,
                    signal: controller.signal
                });

                clearTimeout(timeoutId);
                return response;
            } catch (error) {
                if (retryCount < PERFORMANCE_CONFIG.MAX_RETRY_ATTEMPTS) {
                    // æŒ‡æ•°é€€é¿é‡è¯•
                    const delay = Math.min(1000 * Math.pow(2, retryCount), 5000);
                    await new Promise(resolve => setTimeout(resolve, delay));
                    return fetchWithRetry(url, options, retryCount + 1);
                }
                throw error;
            }
        }

        // åˆå§‹åŒ–åŠ è½½çŠ¶æ€ç®¡ç†
        const loadingStates = {
            LOADING: 'loading',
            READY: 'ready',
            ERROR: 'error'
        };

        let pageState = loadingStates.LOADING;

        // æ˜¾ç¤º/éšè—åŠ è½½æŒ‡ç¤ºå™¨
        function toggleLoading(show) {
            const loader = document.getElementById('loading-indicator');
            if (loader) {
                loader.style.display = show ? 'block' : 'none';
            }
        }

        // å»¶è¿ŸåŠ è½½éå…³é”®èµ„æº
        function loadNonCriticalResources() {
            // åˆå§‹åŒ–åº”ç”¨
            initializeApp();
        }

        const translations = {
            en: {
                cityNotFound: "City not found. Please check the city name and try again.",
                enterCity: "Please enter a city name!",
                networkError: "Failed to fetch weather data. Please try again later.",
                loading: "Loading...",
                recommendedOutfit: "Recommended Outfit",
                weeklyForecast: "7-Day Forecast",
                today: "Today",
                weather: {
                    clear: "Clear",
                    clouds: "Cloudy",
                    rain: "Rainy",
                    snow: "Snowy",
                    thunderstorm: "Thunderstorm",
                    drizzle: "Drizzle",
                    mist: "Misty",
                    fog: "Foggy",
                    unknown: "--"
                },
                outfits: {
                    cold: "â„ï¸ <strong>Cold Weather:</strong><br>- Thick winter coat<br>- Thermal underwear<br>- Wool sweater<br>- Warm pants<br>- Winter boots<br>- Scarf, gloves, and hat",
                    mild: "ğŸ‚ <strong>Mild Weather:</strong><br>- Light jacket or cardigan<br>- Long sleeve shirt<br>- Regular pants or jeans<br>- Comfortable shoes<br>- Light scarf (optional)",
                    warm: "â˜€ï¸ <strong>Warm Weather:</strong><br>- T-shirt or short sleeve shirt<br>- Shorts or light pants<br>- Sandals or breathable shoes<br>- Sun hat<br>- Sunglasses",
                    rainTip: "<br>ğŸŒ§ <strong>Rain Protection:</strong><br>- Waterproof jacket<br>- Umbrella<br>- Water-resistant shoes",
                    snowTip: "<br>â„ï¸ <strong>Snow Protection:</strong><br>- Waterproof snow boots<br>- Extra warm socks<br>- Snow pants<br>- Waterproof gloves"
                },
                outfitTips: {
                    cold: "Warm layers",
                    mild: "Light jacket",
                    warm: "Light clothes"
                },
                apiKeyError: "Please provide a valid OpenWeatherMap API key.",
                humidity: 'Humidity',
                windSpeed: 'Wind Speed',
                lastUpdate: 'Last Update',
                feelsLike: 'Feels Like',
                appTitle: "Best Weather Dress Guide",
                appSubtitle: "Create stunning AI-generated outfits in seconds",
                appInstruction: "Select/input country, city, and date below",
                title: 'Best Weather Dress Guide'
            },
            zh: {
                cityNotFound: "æ‰¾ä¸åˆ°è¯¥åŸå¸‚ï¼Œè¯·æ£€æŸ¥åŸå¸‚åç§°æ˜¯å¦æ­£ç¡®ã€‚",
                enterCity: "è¯·è¾“å…¥åŸå¸‚åç§°ï¼",
                networkError: "è·å–å¤©æ°”æ•°æ®å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ã€‚",
                loading: "åŠ è½½ä¸­...",
                recommendedOutfit: "æ¨èç©¿æ­",
                weeklyForecast: "7å¤©é¢„æŠ¥",
                today: "ä»Šå¤©",
                weather: {
                    clear: "æ™´å¤©",
                    clouds: "å¤šäº‘",
                    rain: "é›¨å¤©",
                    snow: "é›ªå¤©",
                    thunderstorm: "é›·é›¨",
                    drizzle: "å°é›¨",
                    mist: "è–„é›¾",
                    fog: "é›¾",
                    unknown: "--"
                },
                outfits: {
                    cold: "â„ï¸ <strong>å¯’å†·å¤©æ°”ï¼š</strong><br>- åšç¾½ç»’æœæˆ–å†¬å­£å¤–å¥—<br>- ä¿æš–å†…è¡£<br>- æ¯›è¡£<br>- ä¿æš–é•¿è£¤<br>- å†¬é´<br>- å›´å·¾ã€æ‰‹å¥—å’Œå¸½å­",
                    mild: "ğŸ‚ <strong>æ¸©å’Œå¤©æ°”ï¼š</strong><br>- è½»è–„å¤–å¥—æˆ–å¼€è¡«<br>- é•¿è¢–è¡¬è¡«<br>- å¸¸è§„é•¿è£¤æˆ–ç‰›ä»”è£¤<br>- èˆ’é€‚é‹å­<br>- è½»è–„å›´å·¾ï¼ˆå¯é€‰ï¼‰",
                    warm: "â˜€ï¸ <strong>æ¸©æš–å¤©æ°”ï¼š</strong><br>- Tæ¤æˆ–çŸ­è¢–è¡¬è¡«<br>- çŸ­è£¤æˆ–è½»è–„é•¿è£¤<br>- å‡‰é‹æˆ–é€æ°”é‹<br>- é®é˜³å¸½<br>- å¤ªé˜³é•œ",
                    rainTip: "<br>ğŸŒ§ <strong>é›¨å¤©é˜²æŠ¤ï¼š</strong><br>- é˜²æ°´å¤–å¥—<br>- é›¨ä¼<br>- é˜²æ°´é‹",
                    snowTip: "<br>â„ï¸ <strong>é›ªå¤©é˜²æŠ¤ï¼š</strong><br>- é˜²æ°´é›ªåœ°é´<br>- åŠ åšä¿æš–è¢œ<br>- é›ªåœ°è£¤<br>- é˜²æ°´æ‰‹å¥—"
                },
                outfitTips: {
                    cold: "ä¿æš–å±‚è£…",
                    mild: "è½»è–„å¤–å¥—",
                    warm: "æ¸…å‡‰è£…æ‰®"
                },
                apiKeyError: "è¯·æä¾›æœ‰æ•ˆçš„ OpenWeatherMap API å¯†é’¥ã€‚",
                humidity: 'æ¹¿åº¦',
                windSpeed: 'é£é€Ÿ',
                lastUpdate: 'æœ€åæ›´æ–°',
                feelsLike: 'ä½“æ„Ÿæ¸©åº¦',
                appTitle: "æœ€å¥½çš„å¤©æ°”ç©¿è¡£æŒ‡å—",
                appSubtitle: "å‡ ç§’å†…å°†ç”Ÿæˆä»¤äººæƒŠå¹çš„AIæ¨èç©¿æ­",
                appInstruction: "ç›´æ¥åœ¨ä¸‹æ–¹é€‰æ‹©/è¾“å…¥å›½å®¶ï¼ŒåŸå¸‚ï¼Œæ—¥æœŸ",
                title: 'æœ€å¥½çš„å¤©æ°”ç©¿è¡£æŒ‡å—'
            }
        };

        // å¸¸ç”¨å›½å®¶å’ŒåŸå¸‚åˆ—è¡¨
        const popularCities = {
            CN: {
                en: [
                    { name: 'Beijing', latitude: 39.9042, longitude: 116.4074 },
                    { name: 'Shanghai', latitude: 31.2304, longitude: 121.4737 },
                    { name: 'Tianjin', latitude: 39.3434, longitude: 117.3616 },
                    { name: 'Chongqing', latitude: 29.4316, longitude: 106.9123 },
                    { name: 'Guangzhou', latitude: 23.1291, longitude: 113.2644 },
                    { name: 'Nanjing', latitude: 32.0603, longitude: 118.7969 },
                    { name: 'Hangzhou', latitude: 30.2741, longitude: 120.1551 },
                    { name: 'Wuhan', latitude: 30.5928, longitude: 114.3055 },
                    { name: 'Chengdu', latitude: 30.5728, longitude: 104.0668 },
                    { name: 'Xian', latitude: 34.3416, longitude: 108.9398 },
                    { name: 'Jinan', latitude: 36.6512, longitude: 117.1201 },
                    { name: 'Zhengzhou', latitude: 34.7472, longitude: 113.6249 },
                    { name: 'Changsha', latitude: 28.2278, longitude: 112.9388 },
                    { name: 'Fuzhou', latitude: 26.0745, longitude: 119.2965 },
                    { name: 'Nanchang', latitude: 28.6820, longitude: 115.8579 },
                    { name: 'Kunming', latitude: 24.8801, longitude: 102.8329 },
                    { name: 'Hefei', latitude: 31.8206, longitude: 117.2272 },
                    { name: 'Shijiazhuang', latitude: 38.0428, longitude: 114.5149 },
                    { name: 'Taiyuan', latitude: 37.8706, longitude: 112.5489 },
                    { name: 'Changchun', latitude: 43.8171, longitude: 125.3235 },
                    { name: 'Harbin', latitude: 45.8038, longitude: 126.5340 },
                    { name: 'Shenyang', latitude: 41.8057, longitude: 123.4315 },
                    { name: 'Nanning', latitude: 22.8170, longitude: 108.3665 },
                    { name: 'Guiyang', latitude: 26.6470, longitude: 106.6302 },
                    { name: 'Lanzhou', latitude: 36.0611, longitude: 103.8343 },
                    { name: 'Xining', latitude: 36.6232, longitude: 101.7804 },
                    { name: 'Yinchuan', latitude: 38.4872, longitude: 106.2309 },
                    { name: 'Urumqi', latitude: 43.8256, longitude: 87.6168 },
                    { name: 'Hohhot', latitude: 40.8424, longitude: 111.7490 },
                    { name: 'Suzhou', latitude: 31.2990, longitude: 120.5853 },
                    { name: 'Xiamen', latitude: 24.4798, longitude: 118.0819 },
                    { name: 'Guilin', latitude: 25.2744, longitude: 110.2992 },
                    { name: 'Sanya', latitude: 18.2525, longitude: 109.5117 },
                    { name: 'Lijiang', latitude: 26.8721, longitude: 100.2346 },
                    { name: 'Dali', latitude: 25.6065, longitude: 100.2675 },
                    { name: 'Huangshan', latitude: 29.7147, longitude: 118.3147 },
                    { name: 'Zhangjiajie', latitude: 29.1170, longitude: 110.4790 },
                    { name: 'Qingdao', latitude: 36.0671, longitude: 120.3826 },
                    { name: 'Dalian', latitude: 38.9140, longitude: 121.6147 },
                    { name: 'Lhasa', latitude: 29.6500, longitude: 91.1000 }
                ],
                zh: [
                    { name: 'åŒ—äº¬', latitude: 39.9042, longitude: 116.4074 },
                    { name: 'ä¸Šæµ·', latitude: 31.2304, longitude: 121.4737 },
                    { name: 'å¤©æ´¥', latitude: 39.3434, longitude: 117.3616 },
                    { name: 'é‡åº†', latitude: 29.4316, longitude: 106.9123 },
                    { name: 'å¹¿å·', latitude: 23.1291, longitude: 113.2644 },
                    { name: 'å—äº¬', latitude: 32.0603, longitude: 118.7969 },
                    { name: 'æ­å·', latitude: 30.2741, longitude: 120.1551 },
                    { name: 'æ­¦æ±‰', latitude: 30.5928, longitude: 114.3055 },
                    { name: 'æˆéƒ½', latitude: 30.5728, longitude: 104.0668 },
                    { name: 'è¥¿å®‰', latitude: 34.3416, longitude: 108.9398 },
                    { name: 'æµå—', latitude: 36.6512, longitude: 117.1201 },
                    { name: 'éƒ‘å·', latitude: 34.7472, longitude: 113.6249 },
                    { name: 'é•¿æ²™', latitude: 28.2278, longitude: 112.9388 },
                    { name: 'ç¦å·', latitude: 26.0745, longitude: 119.2965 },
                    { name: 'å—æ˜Œ', latitude: 28.6820, longitude: 115.8579 },
                    { name: 'æ˜†æ˜', latitude: 24.8801, longitude: 102.8329 },
                    { name: 'åˆè‚¥', latitude: 31.8206, longitude: 117.2272 },
                    { name: 'çŸ³å®¶åº„', latitude: 38.0428, longitude: 114.5149 },
                    { name: 'å¤ªåŸ', latitude: 37.8706, longitude: 112.5489 },
                    { name: 'é•¿æ˜¥', latitude: 43.8171, longitude: 125.3235 },
                    { name: 'å“ˆå°”æ»¨', latitude: 45.8038, longitude: 126.5340 },
                    { name: 'æ²ˆé˜³', latitude: 41.8057, longitude: 123.4315 },
                    { name: 'å—å®', latitude: 22.8170, longitude: 108.3665 },
                    { name: 'è´µé˜³', latitude: 26.6470, longitude: 106.6302 },
                    { name: 'å…°å·', latitude: 36.0611, longitude: 103.8343 },
                    { name: 'è¥¿å®', latitude: 36.6232, longitude: 101.7804 },
                    { name: 'é“¶å·', latitude: 38.4872, longitude: 106.2309 },
                    { name: 'ä¹Œé²æœ¨é½', latitude: 43.8256, longitude: 87.6168 },
                    { name: 'å‘¼å’Œæµ©ç‰¹', latitude: 40.8424, longitude: 111.7490 },
                    { name: 'è‹å·', latitude: 31.2990, longitude: 120.5853 },
                    { name: 'å¦é—¨', latitude: 24.4798, longitude: 118.0819 },
                    { name: 'æ¡‚æ—', latitude: 25.2744, longitude: 110.2992 },
                    { name: 'ä¸‰äºš', latitude: 18.2525, longitude: 109.5117 },
                    { name: 'ä¸½æ±Ÿ', latitude: 26.8721, longitude: 100.2346 },
                    { name: 'å¤§ç†', latitude: 25.6065, longitude: 100.2675 },
                    { name: 'é»„å±±', latitude: 29.7147, longitude: 118.3147 },
                    { name: 'å¼ å®¶ç•Œ', latitude: 29.1170, longitude: 110.4790 },
                    { name: 'é’å²›', latitude: 36.0671, longitude: 120.3826 },
                    { name: 'å¤§è¿', latitude: 38.9140, longitude: 121.6147 },
                    { name: 'æ‹‰è¨', latitude: 29.6500, longitude: 91.1000 }
                ]
            },
            JP: {
                en: [
                    { name: 'Tokyo', latitude: 35.6762, longitude: 139.6503 },
                    { name: 'Osaka', latitude: 34.6937, longitude: 135.5023 },
                    { name: 'Kyoto', latitude: 35.0116, longitude: 135.7681 },
                    { name: 'Sapporo', latitude: 43.0618, longitude: 141.3545 },
                    { name: 'Fukuoka', latitude: 33.5902, longitude: 130.4017 }
                ],
                zh: [
                    { name: 'ä¸œäº¬', latitude: 35.6762, longitude: 139.6503 },
                    { name: 'å¤§é˜ª', latitude: 34.6937, longitude: 135.5023 },
                    { name: 'äº¬éƒ½', latitude: 35.0116, longitude: 135.7681 },
                    { name: 'æœ­å¹Œ', latitude: 43.0618, longitude: 141.3545 },
                    { name: 'ç¦å†ˆ', latitude: 33.5902, longitude: 130.4017 }
                ]
            },
            US: {
                en: [
                    { name: 'New York', latitude: 40.7128, longitude: -74.0060 },
                    { name: 'Los Angeles', latitude: 34.0522, longitude: -118.2437 },
                    { name: 'Chicago', latitude: 41.8781, longitude: -87.6298 },
                    { name: 'San Francisco', latitude: 37.7749, longitude: -122.4194 },
                    { name: 'Miami', latitude: 25.7617, longitude: -80.1918 },
                    { name: 'Las Vegas', latitude: 36.1699, longitude: -115.1398 }
                ],
                zh: [
                    { name: 'çº½çº¦', latitude: 40.7128, longitude: -74.0060 },
                    { name: 'æ´›æ‰çŸ¶', latitude: 34.0522, longitude: -118.2437 },
                    { name: 'èŠåŠ å“¥', latitude: 41.8781, longitude: -87.6298 },
                    { name: 'æ—§é‡‘å±±', latitude: 37.7749, longitude: -122.4194 },
                    { name: 'è¿ˆé˜¿å¯†', latitude: 25.7617, longitude: -80.1918 },
                    { name: 'æ‹‰æ–¯ç»´åŠ æ–¯', latitude: 36.1699, longitude: -115.1398 }
                ]
            },
            GB: {
                en: [
                    { name: 'London', latitude: 51.5074, longitude: -0.1278 },
                    { name: 'Manchester', latitude: 53.4808, longitude: -2.2426 },
                    { name: 'Edinburgh', latitude: 55.9533, longitude: -3.1883 },
                    { name: 'Liverpool', latitude: 53.4084, longitude: -2.9916 }
                ],
                zh: [
                    { name: 'ä¼¦æ•¦', latitude: 51.5074, longitude: -0.1278 },
                    { name: 'æ›¼å½»æ–¯ç‰¹', latitude: 53.4808, longitude: -2.2426 },
                    { name: 'çˆ±ä¸å ¡', latitude: 55.9533, longitude: -3.1883 },
                    { name: 'åˆ©ç‰©æµ¦', latitude: 53.4084, longitude: -2.9916 }
                ]
            },
            FR: {
                en: [
                    { name: 'Paris', latitude: 48.8566, longitude: 2.3522 },
                    { name: 'Nice', latitude: 43.7102, longitude: 7.2620 },
                    { name: 'Lyon', latitude: 45.7640, longitude: 4.8357 },
                    { name: 'Marseille', latitude: 43.2965, longitude: 5.3698 }
                ],
                zh: [
                    { name: 'å·´é»', latitude: 48.8566, longitude: 2.3522 },
                    { name: 'å°¼æ–¯', latitude: 43.7102, longitude: 7.2620 },
                    { name: 'é‡Œæ˜‚', latitude: 45.7640, longitude: 4.8357 },
                    { name: 'é©¬èµ›', latitude: 43.2965, longitude: 5.3698 }
                ]
            },
            IT: {
                en: [
                    { name: 'Rome', latitude: 41.9028, longitude: 12.4964 },
                    { name: 'Milan', latitude: 45.4642, longitude: 9.1900 },
                    { name: 'Venice', latitude: 45.4408, longitude: 12.3155 },
                    { name: 'Florence', latitude: 43.7696, longitude: 11.2558 }
                ],
                zh: [
                    { name: 'ç½—é©¬', latitude: 41.9028, longitude: 12.4964 },
                    { name: 'ç±³å…°', latitude: 45.4642, longitude: 9.1900 },
                    { name: 'å¨å°¼æ–¯', latitude: 45.4408, longitude: 12.3155 },
                    { name: 'ä½›ç½—ä¼¦è¨', latitude: 43.7696, longitude: 11.2558 }
                ]
            },
            DE: {
                en: [
                    { name: 'Berlin', latitude: 52.5200, longitude: 13.4050 },
                    { name: 'Munich', latitude: 48.1351, longitude: 11.5820 },
                    { name: 'Hamburg', latitude: 53.5511, longitude: 9.9937 },
                    { name: 'Frankfurt', latitude: 50.1109, longitude: 8.6821 }
                ],
                zh: [
                    { name: 'æŸæ—', latitude: 52.5200, longitude: 13.4050 },
                    { name: 'æ…•å°¼é»‘', latitude: 48.1351, longitude: 11.5820 },
                    { name: 'æ±‰å ¡', latitude: 53.5511, longitude: 9.9937 },
                    { name: 'æ³•å…°å…‹ç¦', latitude: 50.1109, longitude: 8.6821 }
                ]
            },
            AU: {
                en: [
                    { name: 'Sydney', latitude: -33.8688, longitude: 151.2093 },
                    { name: 'Melbourne', latitude: -37.8136, longitude: 144.9631 },
                    { name: 'Brisbane', latitude: -27.4705, longitude: 153.0260 },
                    { name: 'Perth', latitude: -31.9505, longitude: 115.8605 }
                ],
                zh: [
                    { name: 'æ‚‰å°¼', latitude: -33.8688, longitude: 151.2093 },
                    { name: 'å¢¨å°”æœ¬', latitude: -37.8136, longitude: 144.9631 },
                    { name: 'å¸ƒé‡Œæ–¯ç­', latitude: -27.4705, longitude: 153.0260 },
                    { name: 'ç€æ–¯', latitude: -31.9505, longitude: 115.8605 }
                ]
            },
            SG: {
                en: [
                    { name: 'Singapore', latitude: 1.3521, longitude: 103.8198 }
                ],
                zh: [
                    { name: 'æ–°åŠ å¡', latitude: 1.3521, longitude: 103.8198 }
                ]
            },
            TH: {
                en: [
                    { name: 'Bangkok', latitude: 13.7563, longitude: 100.5018 },
                    { name: 'Phuket', latitude: 7.8804, longitude: 98.3923 }
                ],
                zh: [
                    { name: 'æ›¼è°·', latitude: 13.7563, longitude: 100.5018 },
                    { name: 'æ™®å‰å²›', latitude: 7.8804, longitude: 98.3923 }
                ]
            },
            KR: {
                en: [
                    { name: 'Seoul', latitude: 37.5665, longitude: 126.9780 },
                    { name: 'Busan', latitude: 35.1796, longitude: 129.0756 },
                    { name: 'Incheon', latitude: 37.4563, longitude: 126.7052 },
                    { name: 'Jeju', latitude: 33.4996, longitude: 126.5312 },
                    { name: 'Daegu', latitude: 35.8714, longitude: 128.6014 },
                    { name: 'Daejeon', latitude: 36.3504, longitude: 127.3845 }
                ],
                zh: [
                    { name: 'é¦–å°”', latitude: 37.5665, longitude: 126.9780 },
                    { name: 'é‡œå±±', latitude: 35.1796, longitude: 129.0756 },
                    { name: 'ä»å·', latitude: 37.4563, longitude: 126.7052 },
                    { name: 'æµå·', latitude: 33.4996, longitude: 126.5312 },
                    { name: 'å¤§é‚±', latitude: 35.8714, longitude: 128.6014 },
                    { name: 'å¤§ç”°', latitude: 36.3504, longitude: 127.3845 }
                ]
            },
            CA: {
                en: [
                    { name: 'Toronto', latitude: 43.6532, longitude: -79.3832 },
                    { name: 'Vancouver', latitude: 49.2827, longitude: -123.1207 },
                    { name: 'Montreal', latitude: 45.5017, longitude: -73.5673 },
                    { name: 'Calgary', latitude: 51.0447, longitude: -114.0719 },
                    { name: 'Ottawa', latitude: 45.4215, longitude: -75.6972 },
                    { name: 'Edmonton', latitude: 53.5461, longitude: -113.4938 }
                ],
                zh: [
                    { name: 'å¤šä¼¦å¤š', latitude: 43.6532, longitude: -79.3832 },
                    { name: 'æ¸©å“¥å', latitude: 49.2827, longitude: -123.1207 },
                    { name: 'è’™ç‰¹åˆ©å°”', latitude: 45.5017, longitude: -73.5673 },
                    { name: 'å¡å°”åŠ é‡Œ', latitude: 51.0447, longitude: -114.0719 },
                    { name: 'æ¸¥å¤ªå', latitude: 45.4215, longitude: -75.6972 },
                    { name: 'åŸƒå¾·è’™é¡¿', latitude: 53.5461, longitude: -113.4938 }
                ]
            },
            ES: {
                en: [
                    { name: 'Madrid', latitude: 40.4168, longitude: -3.7038 },
                    { name: 'Barcelona', latitude: 41.3851, longitude: 2.1734 },
                    { name: 'Valencia', latitude: 39.4699, longitude: -0.3763 },
                    { name: 'Seville', latitude: 37.3891, longitude: -5.9845 },
                    { name: 'Malaga', latitude: 36.7213, longitude: -4.4217 },
                    { name: 'Bilbao', latitude: 43.2630, longitude: -2.9350 }
                ],
                zh: [
                    { name: 'é©¬å¾·é‡Œ', latitude: 40.4168, longitude: -3.7038 },
                    { name: 'å·´å¡ç½—é‚£', latitude: 41.3851, longitude: 2.1734 },
                    { name: 'ç“¦ä¼¦è¥¿äºš', latitude: 39.4699, longitude: -0.3763 },
                    { name: 'å¡ç»´åˆ©äºš', latitude: 37.3891, longitude: -5.9845 },
                    { name: 'é©¬æ‹‰åŠ ', latitude: 36.7213, longitude: -4.4217 },
                    { name: 'æ¯•å°”å·´é„‚', latitude: 43.2630, longitude: -2.9350 }
                ]
            },
            PT: {
                en: [
                    { name: 'Lisbon', latitude: 38.7223, longitude: -9.1393 },
                    { name: 'Porto', latitude: 41.1579, longitude: -8.6291 },
                    { name: 'Faro', latitude: 37.0194, longitude: -7.9322 },
                    { name: 'Coimbra', latitude: 40.2033, longitude: -8.4103 }
                ],
                zh: [
                    { name: 'é‡Œæ–¯æœ¬', latitude: 38.7223, longitude: -9.1393 },
                    { name: 'æ³¢å°”å›¾', latitude: 41.1579, longitude: -8.6291 },
                    { name: 'æ³•é²', latitude: 37.0194, longitude: -7.9322 },
                    { name: 'ç§‘è‹±å¸ƒæ‹‰', latitude: 40.2033, longitude: -8.4103 }
                ]
            },
            NL: {
                en: [
                    { name: 'Amsterdam', latitude: 52.3676, longitude: 4.9041 },
                    { name: 'Rotterdam', latitude: 51.9244, longitude: 4.4777 },
                    { name: 'The Hague', latitude: 52.0705, longitude: 4.3007 },
                    { name: 'Utrecht', latitude: 52.0907, longitude: 5.1214 },
                    { name: 'Eindhoven', latitude: 51.4416, longitude: 5.4697 }
                ],
                zh: [
                    { name: 'é˜¿å§†æ–¯ç‰¹ä¸¹', latitude: 52.3676, longitude: 4.9041 },
                    { name: 'é¹¿ç‰¹ä¸¹', latitude: 51.9244, longitude: 4.4777 },
                    { name: 'æµ·ç‰™', latitude: 52.0705, longitude: 4.3007 },
                    { name: 'ä¹Œç‰¹å‹’æ”¯', latitude: 52.0907, longitude: 5.1214 },
                    { name: 'åŸƒå› éœæ¸©', latitude: 51.4416, longitude: 5.4697 }
                ]
            },
            CH: {
                en: [
                    { name: 'Zurich', latitude: 47.3769, longitude: 8.5417 },
                    { name: 'Geneva', latitude: 46.2044, longitude: 6.1432 },
                    { name: 'Basel', latitude: 47.5596, longitude: 7.5886 },
                    { name: 'Bern', latitude: 46.9480, longitude: 7.4474 },
                    { name: 'Lausanne', latitude: 46.5197, longitude: 6.6323 }
                ],
                zh: [
                    { name: 'è‹é»ä¸–', latitude: 47.3769, longitude: 8.5417 },
                    { name: 'æ—¥å†…ç“¦', latitude: 46.2044, longitude: 6.1432 },
                    { name: 'å·´å¡å°”', latitude: 47.5596, longitude: 7.5886 },
                    { name: 'ä¼¯å°”å°¼', latitude: 46.9480, longitude: 7.4474 },
                    { name: 'æ´›æ¡‘', latitude: 46.5197, longitude: 6.6323 }
                ]
            },
            SE: {
                en: [
                    { name: 'Stockholm', latitude: 59.3293, longitude: 18.0686 },
                    { name: 'Gothenburg', latitude: 57.7089, longitude: 11.9746 },
                    { name: 'Malmo', latitude: 55.6044, longitude: 13.0038 },
                    { name: 'Uppsala', latitude: 59.8586, longitude: 17.6389 }
                ],
                zh: [
                    { name: 'æ–¯å¾·å“¥å°”æ‘©', latitude: 59.3293, longitude: 18.0686 },
                    { name: 'å“¥å¾·å ¡', latitude: 57.7089, longitude: 11.9746 },
                    { name: 'é©¬å°”é»˜', latitude: 55.6044, longitude: 13.0038 },
                    { name: 'ä¹Œæ™®è¨æ‹‰', latitude: 59.8586, longitude: 17.6389 }
                ]
            },
            NO: {
                en: [
                    { name: 'Oslo', latitude: 59.9139, longitude: 10.7522 },
                    { name: 'Bergen', latitude: 60.3913, longitude: 5.3221 },
                    { name: 'Trondheim', latitude: 63.4305, longitude: 10.3951 },
                    { name: 'Stavanger', latitude: 58.9700, longitude: 5.7331 }
                ],
                zh: [
                    { name: 'å¥¥æ–¯é™†', latitude: 59.9139, longitude: 10.7522 },
                    { name: 'å‘å°”æ ¹', latitude: 60.3913, longitude: 5.3221 },
                    { name: 'ç‰¹éš†èµ«å§†', latitude: 63.4305, longitude: 10.3951 },
                    { name: 'æ–¯å¡”ä¸‡æ ¼', latitude: 58.9700, longitude: 5.7331 }
                ]
            },
            NZ: {
                en: [
                    { name: 'Auckland', latitude: -36.8485, longitude: 174.7633 },
                    { name: 'Wellington', latitude: -41.2866, longitude: 174.7756 },
                    { name: 'Christchurch', latitude: -43.5320, longitude: 172.6306 },
                    { name: 'Hamilton', latitude: -37.7870, longitude: 175.2793 },
                    { name: 'Dunedin', latitude: -45.8788, longitude: 170.5028 }
                ],
                zh: [
                    { name: 'å¥¥å…‹å…°', latitude: -36.8485, longitude: 174.7633 },
                    { name: 'æƒ çµé¡¿', latitude: -41.2866, longitude: 174.7756 },
                    { name: 'åŸºç£åŸ', latitude: -43.5320, longitude: 172.6306 },
                    { name: 'æ±‰å¯†å°”é¡¿', latitude: -37.7870, longitude: 175.2793 },
                    { name: 'ä½†å°¼ä¸', latitude: -45.8788, longitude: 170.5028 }
                ]
            },
            AE: {
                en: [
                    { name: 'Dubai', latitude: 25.2048, longitude: 55.2708 },
                    { name: 'Abu Dhabi', latitude: 24.4539, longitude: 54.3773 },
                    { name: 'Sharjah', latitude: 25.3573, longitude: 55.4033 },
                    { name: 'Ajman', latitude: 25.4052, longitude: 55.5136 },
                    { name: 'Ras Al Khaimah', latitude: 25.7895, longitude: 55.9432 }
                ],
                zh: [
                    { name: 'è¿ªæ‹œ', latitude: 25.2048, longitude: 55.2708 },
                    { name: 'é˜¿å¸ƒæ‰æ¯”', latitude: 24.4539, longitude: 54.3773 },
                    { name: 'æ²™è¿¦', latitude: 25.3573, longitude: 55.4033 },
                    { name: 'é˜¿æ²»æ›¼', latitude: 25.4052, longitude: 55.5136 },
                    { name: 'å“ˆä¼Šé©¬è§’', latitude: 25.7895, longitude: 55.9432 }
                ]
            },
            RU: {
                en: [
                    { name: 'Moscow', latitude: 55.7558, longitude: 37.6173 },
                    { name: 'Saint Petersburg', latitude: 59.9343, longitude: 30.3351 },
                    { name: 'Novosibirsk', latitude: 55.0084, longitude: 82.9357 },
                    { name: 'Yekaterinburg', latitude: 56.8389, longitude: 60.6057 },
                    { name: 'Kazan', latitude: 55.7887, longitude: 49.1221 }
                ],
                zh: [
                    { name: 'è«æ–¯ç§‘', latitude: 55.7558, longitude: 37.6173 },
                    { name: 'åœ£å½¼å¾—å ¡', latitude: 59.9343, longitude: 30.3351 },
                    { name: 'æ–°è¥¿ä¼¯åˆ©äºš', latitude: 55.0084, longitude: 82.9357 },
                    { name: 'å¶å¡æ·ç³å ¡', latitude: 56.8389, longitude: 60.6057 },
                    { name: 'å–€å±±', latitude: 55.7887, longitude: 49.1221 }
                ]
            },
            BR: {
                en: [
                    { name: 'Sao Paulo', latitude: -23.5505, longitude: -46.6333 },
                    { name: 'Rio de Janeiro', latitude: -22.9068, longitude: -43.1729 },
                    { name: 'Brasilia', latitude: -15.7975, longitude: -47.8919 },
                    { name: 'Salvador', latitude: -12.9714, longitude: -38.5014 },
                    { name: 'Fortaleza', latitude: -3.7319, longitude: -38.5267 }
                ],
                zh: [
                    { name: 'åœ£ä¿ç½—', latitude: -23.5505, longitude: -46.6333 },
                    { name: 'é‡Œçº¦çƒ­å†…å¢', latitude: -22.9068, longitude: -43.1729 },
                    { name: 'å·´è¥¿åˆ©äºš', latitude: -15.7975, longitude: -47.8919 },
                    { name: 'è¨å°”ç“¦å¤š', latitude: -12.9714, longitude: -38.5014 },
                    { name: 'ç¦å¡”è±è¨', latitude: -3.7319, longitude: -38.5267 }
                ]
            },
            IN: {
                en: [
                    { name: 'New Delhi', latitude: 28.6139, longitude: 77.2090 },
                    { name: 'Mumbai', latitude: 19.0760, longitude: 72.8777 },
                    { name: 'Bangalore', latitude: 12.9716, longitude: 77.5946 },
                    { name: 'Chennai', latitude: 13.0827, longitude: 80.2707 },
                    { name: 'Kolkata', latitude: 22.5726, longitude: 88.3639 }
                ],
                zh: [
                    { name: 'æ–°å¾·é‡Œ', latitude: 28.6139, longitude: 77.2090 },
                    { name: 'å­Ÿä¹°', latitude: 19.0760, longitude: 72.8777 },
                    { name: 'ç­åŠ ç½—å°”', latitude: 12.9716, longitude: 77.5946 },
                    { name: 'é‡‘å¥ˆ', latitude: 13.0827, longitude: 80.2707 },
                    { name: 'åŠ å°”å„ç­”', latitude: 22.5726, longitude: 88.3639 }
                ]
            },
            MX: {
                en: [
                    { name: 'Mexico City', latitude: 19.4326, longitude: -99.1332 },
                    { name: 'Guadalajara', latitude: 20.6597, longitude: -103.3496 },
                    { name: 'Monterrey', latitude: 25.6866, longitude: -100.3161 },
                    { name: 'Cancun', latitude: 21.1619, longitude: -86.8515 },
                    { name: 'Tijuana', latitude: 32.5149, longitude: -117.0382 }
                ],
                zh: [
                    { name: 'å¢¨è¥¿å“¥åŸ', latitude: 19.4326, longitude: -99.1332 },
                    { name: 'ç“œè¾¾æ‹‰å“ˆæ‹‰', latitude: 20.6597, longitude: -103.3496 },
                    { name: 'è’™ç‰¹é›·', latitude: 25.6866, longitude: -100.3161 },
                    { name: 'åæ˜†', latitude: 21.1619, longitude: -86.8515 },
                    { name: 'è’‚åçº³', latitude: 32.5149, longitude: -117.0382 }
                ]
            },
            AR: {
                en: [
                    { name: 'Buenos Aires', latitude: -34.6037, longitude: -58.3816 },
                    { name: 'Cordoba', latitude: -31.4201, longitude: -64.1888 },
                    { name: 'Rosario', latitude: -32.9468, longitude: -60.6393 },
                    { name: 'Mendoza', latitude: -32.8908, longitude: -68.8272 },
                    { name: 'Mar del Plata', latitude: -38.0055, longitude: -57.5426 }
                ],
                zh: [
                    { name: 'å¸ƒå®œè¯ºæ–¯è‰¾åˆ©æ–¯', latitude: -34.6037, longitude: -58.3816 },
                    { name: 'ç§‘å°”å¤šç“¦', latitude: -31.4201, longitude: -64.1888 },
                    { name: 'ç½—è¨é‡Œå¥¥', latitude: -32.9468, longitude: -60.6393 },
                    { name: 'é—¨å¤šè¨', latitude: -32.8908, longitude: -68.8272 },
                    { name: 'é©¬å¾·æ™®æ‹‰å¡”', latitude: -38.0055, longitude: -57.5426 }
                ]
            },
            ZA: {
                en: [
                    { name: 'Cape Town', latitude: -33.9249, longitude: 18.4241 },
                    { name: 'Johannesburg', latitude: -26.2041, longitude: 28.0473 },
                    { name: 'Durban', latitude: -29.8587, longitude: 31.0218 },
                    { name: 'Pretoria', latitude: -25.7461, longitude: 28.1881 },
                    { name: 'Port Elizabeth', latitude: -33.7139, longitude: 25.5207 }
                ],
                zh: [
                    { name: 'å¼€æ™®æ•¦', latitude: -33.9249, longitude: 18.4241 },
                    { name: 'çº¦ç¿°å†…æ–¯å ¡', latitude: -26.2041, longitude: 28.0473 },
                    { name: 'å¾·ç­', latitude: -29.8587, longitude: 31.0218 },
                    { name: 'æ¯”å‹’é™€åˆ©äºš', latitude: -25.7461, longitude: 28.1881 },
                    { name: 'ä¼Šä¸½èç™½æ¸¯', latitude: -33.7139, longitude: 25.5207 }
                ]
            },
            EG: {
                en: [
                    { name: 'Cairo', latitude: 30.0444, longitude: 31.2357 },
                    { name: 'Alexandria', latitude: 31.2001, longitude: 29.9187 },
                    { name: 'Giza', latitude: 30.0131, longitude: 31.2089 },
                    { name: 'Luxor', latitude: 25.6872, longitude: 32.6396 },
                    { name: 'Aswan', latitude: 24.0889, longitude: 32.8998 }
                ],
                zh: [
                    { name: 'å¼€ç½—', latitude: 30.0444, longitude: 31.2357 },
                    { name: 'äºšå†å±±å¤§', latitude: 31.2001, longitude: 29.9187 },
                    { name: 'å‰è¨', latitude: 30.0131, longitude: 31.2089 },
                    { name: 'å¢å…‹ç´¢', latitude: 25.6872, longitude: 32.6396 },
                    { name: 'é˜¿æ–¯æ—º', latitude: 24.0889, longitude: 32.8998 }
                ]
            },
            GR: {
                en: [
                    { name: 'Athens', latitude: 37.9838, longitude: 23.7275 },
                    { name: 'Thessaloniki', latitude: 40.6401, longitude: 22.9444 },
                    { name: 'Heraklion', latitude: 35.3387, longitude: 25.1442 },
                    { name: 'Rhodes', latitude: 36.4341, longitude: 28.2176 },
                    { name: 'Patras', latitude: 38.2466, longitude: 21.7346 }
                ],
                zh: [
                    { name: 'é›…å…¸', latitude: 37.9838, longitude: 23.7275 },
                    { name: 'å¡è¨æ´›å°¼åŸº', latitude: 40.6401, longitude: 22.9444 },
                    { name: 'ä¼Šæ‹‰å…‹åˆ©ç¿', latitude: 35.3387, longitude: 25.1442 },
                    { name: 'ç½—å¾·å²›', latitude: 36.4341, longitude: 28.2176 },
                    { name: 'å¸•ç‰¹é›·', latitude: 38.2466, longitude: 21.7346 }
                ]
            },
            TR: {
                en: [
                    { name: 'Istanbul', latitude: 41.0082, longitude: 28.9784 },
                    { name: 'Ankara', latitude: 39.9334, longitude: 32.8597 },
                    { name: 'Izmir', latitude: 38.4237, longitude: 27.1428 },
                    { name: 'Antalya', latitude: 36.8969, longitude: 30.7133 },
                    { name: 'Bursa', latitude: 40.1885, longitude: 29.0610 }
                ],
                zh: [
                    { name: 'ä¼Šæ–¯å¦å¸ƒå°”', latitude: 41.0082, longitude: 28.9784 },
                    { name: 'å®‰å¡æ‹‰', latitude: 39.9334, longitude: 32.8597 },
                    { name: 'ä¼Šå…¹å¯†å°”', latitude: 38.4237, longitude: 27.1428 },
                    { name: 'å®‰å¡”åˆ©äºš', latitude: 36.8969, longitude: 30.7133 },
                    { name: 'å¸ƒå°”è¨', latitude: 40.1885, longitude: 29.0610 }
                ]
            },
            AT: {
                en: [
                    { name: 'Vienna', latitude: 48.2082, longitude: 16.3738 },
                    { name: 'Salzburg', latitude: 47.8095, longitude: 13.0550 },
                    { name: 'Innsbruck', latitude: 47.2692, longitude: 11.4041 },
                    { name: 'Graz', latitude: 47.0707, longitude: 15.4395 },
                    { name: 'Linz', latitude: 48.3069, longitude: 14.2858 }
                ],
                zh: [
                    { name: 'ç»´ä¹Ÿçº³', latitude: 48.2082, longitude: 16.3738 },
                    { name: 'è¨å°”èŒ¨å ¡', latitude: 47.8095, longitude: 13.0550 },
                    { name: 'å› æ–¯å¸ƒé²å…‹', latitude: 47.2692, longitude: 11.4041 },
                    { name: 'æ ¼æ‹‰èŒ¨', latitude: 47.0707, longitude: 15.4395 },
                    { name: 'æ—èŒ¨', latitude: 48.3069, longitude: 14.2858 }
                ]
            },
            BE: {
                en: [
                    { name: 'Brussels', latitude: 50.8503, longitude: 4.3517 },
                    { name: 'Antwerp', latitude: 51.2194, longitude: 4.4025 },
                    { name: 'Ghent', latitude: 51.0543, longitude: 3.7174 },
                    { name: 'Bruges', latitude: 51.2093, longitude: 3.2247 },
                    { name: 'Liege', latitude: 50.6326, longitude: 5.5797 }
                ],
                zh: [
                    { name: 'å¸ƒé²å¡å°”', latitude: 50.8503, longitude: 4.3517 },
                    { name: 'å®‰ç‰¹å«æ™®', latitude: 51.2194, longitude: 4.4025 },
                    { name: 'æ ¹ç‰¹', latitude: 51.0543, longitude: 3.7174 },
                    { name: 'å¸ƒé²æ—¥', latitude: 51.2093, longitude: 3.2247 },
                    { name: 'åˆ—æ—¥', latitude: 50.6326, longitude: 5.5797 }
                ]
            },
            DK: {
                en: [
                    { name: 'Copenhagen', latitude: 55.6761, longitude: 12.5683 },
                    { name: 'Aarhus', latitude: 56.1567, longitude: 10.2108 },
                    { name: 'Odense', latitude: 55.4038, longitude: 10.4024 },
                    { name: 'Aalborg', latitude: 57.0488, longitude: 9.9217 },
                    { name: 'Esbjerg', latitude: 55.4768, longitude: 8.4595 }
                ],
                zh: [
                    { name: 'å“¥æœ¬å“ˆæ ¹', latitude: 55.6761, longitude: 12.5683 },
                    { name: 'å¥¥èƒ¡æ–¯', latitude: 56.1567, longitude: 10.2108 },
                    { name: 'æ¬§ç™»å¡', latitude: 55.4038, longitude: 10.4024 },
                    { name: 'å¥¥å°”å ¡', latitude: 57.0488, longitude: 9.9217 },
                    { name: 'åŸƒæ–¯æ¯”çº¦', latitude: 55.4768, longitude: 8.4595 }
                ]
            },
            FI: {
                en: [
                    { name: 'Helsinki', latitude: 60.1699, longitude: 24.9384 },
                    { name: 'Tampere', latitude: 61.4978, longitude: 23.7610 },
                    { name: 'Turku', latitude: 60.4518, longitude: 22.2666 },
                    { name: 'Oulu', latitude: 65.0121, longitude: 25.4651 },
                    { name: 'Espoo', latitude: 60.2055, longitude: 24.6559 }
                ],
                zh: [
                    { name: 'èµ«å°”è¾›åŸº', latitude: 60.1699, longitude: 24.9384 },
                    { name: 'å¦ä½©é›·', latitude: 61.4978, longitude: 23.7610 },
                    { name: 'å›¾å°”åº“', latitude: 60.4518, longitude: 22.2666 },
                    { name: 'å¥¥å¢', latitude: 65.0121, longitude: 25.4651 },
                    { name: 'åŸƒæ–¯æ³¢', latitude: 60.2055, longitude: 24.6559 }
                ]
            },
            IE: {
                en: [
                    { name: 'Dublin', latitude: 53.3498, longitude: -6.2603 },
                    { name: 'Cork', latitude: 51.8985, longitude: -8.4756 },
                    { name: 'Galway', latitude: 53.2707, longitude: -9.0568 },
                    { name: 'Limerick', latitude: 52.6638, longitude: -8.6267 },
                    { name: 'Waterford', latitude: 52.2593, longitude: -7.1192 }
                ],
                zh: [
                    { name: 'éƒ½æŸæ—', latitude: 53.3498, longitude: -6.2603 },
                    { name: 'ç§‘å…‹', latitude: 51.8985, longitude: -8.4756 },
                    { name: 'æˆˆå°”éŸ¦', latitude: 53.2707, longitude: -9.0568 },
                    { name: 'åˆ©é»˜é‡Œå…‹', latitude: 52.6638, longitude: -8.6267 },
                    { name: 'æ²ƒç‰¹ç¦å¾·', latitude: 52.2593, longitude: -7.1192 }
                ]
            },
            IL: {
                en: [
                    { name: 'Jerusalem', latitude: 31.7683, longitude: 35.2137 },
                    { name: 'Tel Aviv', latitude: 32.0853, longitude: 34.7818 },
                    { name: 'Haifa', latitude: 32.7940, longitude: 34.9896 },
                    { name: 'Eilat', latitude: 29.5577, longitude: 34.9519 },
                    { name: 'Beer Sheva', latitude: 31.2518, longitude: 34.7913 }
                ],
                zh: [
                    { name: 'è€¶è·¯æ’’å†·', latitude: 31.7683, longitude: 35.2137 },
                    { name: 'ç‰¹æ‹‰ç»´å¤«', latitude: 32.0853, longitude: 34.7818 },
                    { name: 'æµ·æ³•', latitude: 32.7940, longitude: 34.9896 },
                    { name: 'åŸƒæ‹‰ç‰¹', latitude: 29.5577, longitude: 34.9519 },
                    { name: 'è´å°”è°¢å·´', latitude: 31.2518, longitude: 34.7913 }
                ]
            }
        };

        // æ›´æ–°å¸¸ç”¨å›½å®¶åˆ—è¡¨
        const popularCountries = {
            en: [
                { code: 'CN', name: 'China' },
                { code: 'JP', name: 'Japan' },
                { code: 'US', name: 'United States' },
                { code: 'GB', name: 'United Kingdom' },
                { code: 'FR', name: 'France' },
                { code: 'IT', name: 'Italy' },
                { code: 'DE', name: 'Germany' },
                { code: 'AU', name: 'Australia' },
                { code: 'SG', name: 'Singapore' },
                { code: 'TH', name: 'Thailand' },
                { code: 'KR', name: 'South Korea' },
                { code: 'CA', name: 'Canada' },
                { code: 'ES', name: 'Spain' },
                { code: 'PT', name: 'Portugal' },
                { code: 'NL', name: 'Netherlands' },
                { code: 'CH', name: 'Switzerland' },
                { code: 'SE', name: 'Sweden' },
                { code: 'NO', name: 'Norway' },
                { code: 'NZ', name: 'New Zealand' },
                { code: 'AE', name: 'United Arab Emirates' },
                { code: 'RU', name: 'Russia' },
                { code: 'BR', name: 'Brazil' },
                { code: 'IN', name: 'India' },
                { code: 'MX', name: 'Mexico' },
                { code: 'AR', name: 'Argentina' },
                { code: 'ZA', name: 'South Africa' },
                { code: 'EG', name: 'Egypt' },
                { code: 'GR', name: 'Greece' },
                { code: 'TR', name: 'Turkey' },
                { code: 'AT', name: 'Austria' },
                { code: 'BE', name: 'Belgium' },
                { code: 'DK', name: 'Denmark' },
                { code: 'FI', name: 'Finland' },
                { code: 'IE', name: 'Ireland' },
                { code: 'IL', name: 'Israel' }
            ],
            zh: [
                { code: 'CN', name: 'ä¸­å›½' },
                { code: 'JP', name: 'æ—¥æœ¬' },
                { code: 'US', name: 'ç¾å›½' },
                { code: 'GB', name: 'è‹±å›½' },
                { code: 'FR', name: 'æ³•å›½' },
                { code: 'IT', name: 'æ„å¤§åˆ©' },
                { code: 'DE', name: 'å¾·å›½' },
                { code: 'AU', name: 'æ¾³å¤§åˆ©äºš' },
                { code: 'SG', name: 'æ–°åŠ å¡' },
                { code: 'TH', name: 'æ³°å›½' },
                { code: 'KR', name: 'éŸ©å›½' },
                { code: 'CA', name: 'åŠ æ‹¿å¤§' },
                { code: 'ES', name: 'è¥¿ç­ç‰™' },
                { code: 'PT', name: 'è‘¡è„ç‰™' },
                { code: 'NL', name: 'è·å…°' },
                { code: 'CH', name: 'ç‘å£«' },
                { code: 'SE', name: 'ç‘å…¸' },
                { code: 'NO', name: 'æŒªå¨' },
                { code: 'NZ', name: 'æ–°è¥¿å…°' },
                { code: 'AE', name: 'é˜¿è”é…‹' },
                { code: 'RU', name: 'ä¿„ç½—æ–¯' },
                { code: 'BR', name: 'å·´è¥¿' },
                { code: 'IN', name: 'å°åº¦' },
                { code: 'MX', name: 'å¢¨è¥¿å“¥' },
                { code: 'AR', name: 'é˜¿æ ¹å»·' },
                { code: 'ZA', name: 'å—é' },
                { code: 'EG', name: 'åŸƒåŠ' },
                { code: 'GR', name: 'å¸Œè…Š' },
                { code: 'TR', name: 'åœŸè€³å…¶' },
                { code: 'AT', name: 'å¥¥åœ°åˆ©' },
                { code: 'BE', name: 'æ¯”åˆ©æ—¶' },
                { code: 'DK', name: 'ä¸¹éº¦' },
                { code: 'FI', name: 'èŠ¬å…°' },
                { code: 'IE', name: 'çˆ±å°”å…°' },
                { code: 'IL', name: 'ä»¥è‰²åˆ—' }
            ]
        };

        // å½“å‰é€‰æ‹©çš„çŠ¶æ€
        const currentSelection = {
            en: { country: null, city: null, date: null },
            zh: { country: null, city: null, date: null }
        };

        // å½“å‰è¯­è¨€
        let currentLang = 'zh';

        // Open-Meteo API é…ç½®
        const OPEN_METEO_API = {
            WEATHER: 'https://api.open-meteo.com/v1',
            GEO: 'https://geocoding-api.open-meteo.com/v1'
        };

        let refreshTimer = null; // æ·»åŠ å®šæ—¶å™¨å˜é‡
        
        // æ·»åŠ æ¸…ç†å‡½æ•°
        function cleanup() {
            if (refreshTimer) {
                clearInterval(refreshTimer);
                refreshTimer = null;
            }
        }

        // é¡µé¢å¸è½½æ—¶æ¸…ç†
        window.addEventListener('beforeunload', cleanup);

        // æ”¹è¿›è‡ªåŠ¨åˆ·æ–°å‡½æ•°
        function startAutoRefresh() {
            // æ¸…ç†å·²å­˜åœ¨çš„å®šæ—¶å™¨
            cleanup();
            
            // è®¾ç½®æ–°çš„å®šæ—¶å™¨ (15åˆ†é’Ÿåˆ·æ–°ä¸€æ¬¡)
            refreshTimer = setInterval(() => {
                const currentCity = currentSelection[currentLang].city;
                if (currentCity) {
                    getWeatherData(currentCity.lat, currentCity.lon, currentLang);
                }
            }, 15 * 60 * 1000);
        }

        // æ‰‹åŠ¨åˆ·æ–°å‡½æ•°
        async function manualRefresh() {
            const refreshButton = document.querySelector('.refresh-button');
            if (!refreshButton || refreshButton.disabled) return;

            refreshButton.disabled = true;
            refreshButton.classList.add('rotating');

            const currentCity = currentSelection[currentLang].city;
            if (currentCity) {
                await getWeatherData(currentCity.lat, currentCity.lon, currentLang);
            }

            setTimeout(() => {
                refreshButton.disabled = false;
                refreshButton.classList.remove('rotating');
            }, 2000);
        }

        // ä¼˜åŒ–è¯­è¨€åˆå§‹åŒ–
        function initializeLanguage() {
            const savedLang = localStorage.getItem('preferred_language') || 'zh';
            currentLang = savedLang;
            
            // æ›´æ–°è¯­è¨€æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.language-btn').forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('onclick').includes(savedLang));
            });

            // æ›´æ–°ç•Œé¢æ–‡æœ¬
            updateInterfaceText(currentLang);
        }

        // ä¼˜åŒ–ç•Œé¢æ–‡æœ¬æ›´æ–°
        function updateInterfaceText(lang) {
            // æ›´æ–°æ ‡é¢˜å’Œå…¶ä»–æ–‡æœ¬
            document.querySelector('.app-title').textContent = translations[lang].appTitle;
            document.querySelector('.app-subtitle').textContent = translations[lang].appSubtitle;
            document.querySelector('.app-instruction').textContent = translations[lang].appInstruction;
            
            // æ›´æ–°å¯¼èˆªæ ‡é¢˜
            document.querySelector('#country-title .nav-text').textContent = 
                lang === 'zh' ? 'é€‰æ‹©å›½å®¶' : 'Select Country';
            document.querySelector('#city-title .nav-text').textContent = 
                lang === 'zh' ? 'é€‰æ‹©åŸå¸‚' : 'Select City';
            document.querySelector('#date-title .nav-text').textContent = 
                lang === 'zh' ? 'é€‰æ‹©æ—¥æœŸ' : 'Select Date';

            // æ›´æ–°æœç´¢æ¡†å ä½ç¬¦
            const countrySearch = document.querySelector('#country-list .search-box');
            const citySearch = document.querySelector('#city-list .search-box');
            if (countrySearch) {
                countrySearch.placeholder = lang === 'zh' ? 'æœç´¢å›½å®¶...' : 'Search country...';
            }
            if (citySearch) {
                citySearch.placeholder = lang === 'zh' ? 'æœç´¢åŸå¸‚...' : 'Search city...';
            }

            // é‡æ–°æ¸²æŸ“å›½å®¶åˆ—è¡¨
            renderCountryList(lang);

            // å¦‚æœå·²ç»é€‰æ‹©äº†åŸå¸‚ï¼Œæ›´æ–°å¤©æ°”ä¿¡æ¯
            const currentCity = currentSelection[lang]?.city;
            if (currentCity) {
                getWeatherData(currentCity.lat, currentCity.lon, lang);
            }
        }

        // ä¼˜åŒ–æœ€è¿‘åŸå¸‚åŠ è½½
        function loadRecentCities() {
            try {
                const recentCities = JSON.parse(localStorage.getItem('recentCities')) || [];
                if (recentCities.length > 0) {
                    const city = recentCities[0];
                    if (city.lat && city.lon) {
                        getWeatherData(city.lat, city.lon, currentLang);
                    }
                }
            } catch (error) {
                console.error('Error loading recent cities:', error);
            }
        }

        // ä¼˜åŒ–å¤©æ°”æ•°æ®è·å–
        async function getWeatherData(lat, lon, lang) {
            // æ£€æŸ¥ç¼“å­˜
            const cachedData = WeatherCache.get(lat, lon);
            if (cachedData) {
                requestAnimationFrame(() => {
                    showWeatherInfo(cachedData, 0, lang);
                    generateOutfitRecommendations(cachedData, 0, lang);
                });
                return;
            }
            
            try {
                const weatherUrl = `${OPEN_METEO_API.WEATHER}/forecast?latitude=${lat}&longitude=${lon}`
                    + `&hourly=temperature_2m,relative_humidity_2m,precipitation_probability,weather_code,wind_speed_10m`
                    + `&daily=weather_code,temperature_2m_max,temperature_2m_min,precipitation_probability_max,wind_speed_10m_max`
                    + `&current_weather=true&timezone=auto&forecast_days=7`;

                const response = await fetchWithRetry(weatherUrl);
                if (!response.ok) throw new Error(`API Error: ${response.status}`);

                const data = await response.json();
                if (!data || !data.current_weather || !data.daily || !data.hourly) {
                    throw new Error('Invalid data structure');
                }

                const weatherData = processWeatherData(data, lang);
                WeatherCache.set(lat, lon, weatherData);

                requestAnimationFrame(() => {
                    showWeatherInfo(weatherData, 0, lang);
                    generateOutfitRecommendations(weatherData, 0, lang);
                });

                startAutoRefresh();
        } catch (error) {
                handleWeatherError(error, lang);
            }
        }

        // ä¼˜åŒ–å¤©æ°”æ•°æ®å¤„ç†
        function processWeatherData(data, lang) {
            const currentHourIndex = new Date().getHours();
            
            // ç¡®ä¿æ‰€æœ‰æ•°æ®éƒ½æœ‰é»˜è®¤å€¼ï¼Œç‰¹åˆ«æ³¨æ„é£é€Ÿæ•°æ®çš„å¤„ç†
            const current = {
                temp: data.current_weather?.temperature ?? '--',
                feels_like: data.hourly?.temperature_2m?.[currentHourIndex] ?? '--',
                humidity: data.hourly?.relative_humidity_2m?.[currentHourIndex] ?? '--',
                wind_speed: data.current_weather?.windspeed ?? '--',  // ä¿®æ”¹è¿™é‡Œï¼Œä½¿ç”¨ windspeed è€Œä¸æ˜¯ wind_speed
                weather_code: data.current_weather?.weathercode ?? 0,  // ä½¿ç”¨ weathercode
                last_update: new Date().toLocaleTimeString(lang === 'zh' ? 'zh-CN' : 'en-US')
            };

            // æ·»åŠ æ•°æ®éªŒè¯å’Œé»˜è®¤å€¼
            return {
                current,
                daily: {
                    temperature_2m_max: data.daily?.temperature_2m_max || Array(7).fill('--'),
                    temperature_2m_min: data.daily?.temperature_2m_min || Array(7).fill('--'),
                    weather_code: data.daily?.weathercode || Array(7).fill(0),  // ä½¿ç”¨ weathercode
                    precipitation_probability_max: data.daily?.precipitation_probability_max || Array(7).fill('--'),
                    wind_speed_10m_max: data.daily?.wind_speed_10m_max || Array(7).fill('--')
                },
                hourly: {
                    temperature: (data.hourly?.temperature_2m || Array(24).fill('--')).slice(0, 24),
                    humidity: (data.hourly?.relative_humidity_2m || Array(24).fill('--')).slice(0, 24),
                    precipitation_probability: (data.hourly?.precipitation_probability || Array(24).fill('--')).slice(0, 24),
                    weather_code: (data.hourly?.weathercode || Array(24).fill(0)).slice(0, 24),  // ä½¿ç”¨ weathercode
                    wind_speed: (data.hourly?.windspeed_10m || Array(24).fill('--')).slice(0, 24)  // ä½¿ç”¨ windspeed_10m
                }
            };
        }

        // ä¼˜åŒ–é”™è¯¯å¤„ç†
        function handleWeatherError(error, lang) {
            console.error('Error fetching weather data:', error);
            
            let errorType = ErrorTypes.NETWORK;
            let errorMessage = translations[lang].networkError;

            if (error.message === 'Request timeout') {
                errorType = ErrorTypes.TIMEOUT;
                errorMessage = translations[lang].timeoutError || 'Request timed out. Please try again.';
            } else if (error.message.includes('API Error')) {
                errorType = ErrorTypes.API;
                errorMessage = translations[lang].apiError || 'Weather service error. Please try again later.';
            } else if (error.message === 'Invalid data structure') {
                errorType = ErrorTypes.INVALID_DATA;
                errorMessage = translations[lang].dataError || 'Invalid weather data received.';
            }

            showError(errorMessage, errorType);
        }

        // é”™è¯¯ç±»å‹å®šä¹‰
        const ErrorTypes = {
            NETWORK: 'network',
            TIMEOUT: 'timeout',
            API: 'api',
            INVALID_DATA: 'invalid_data'
        };

        // æ”¹è¿›é”™è¯¯æ˜¾ç¤ºå‡½æ•°
        function showError(message, type = ErrorTypes.NETWORK) {
            const errorContainer = document.getElementById('error-container');
            if (!errorContainer) return;

            const errorClass = `error-${type}`;
            errorContainer.className = `error-message ${errorClass}`;
            errorContainer.textContent = message;
            errorContainer.style.display = 'block';

            // 5ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                errorContainer.style.display = 'none';
            }, 5000);
        }

        // æ·»åŠ è¶…æ—¶æ§åˆ¶çš„fetchå‡½æ•°
        async function fetchWithTimeout(url, timeout = 10000) {
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), timeout);

            try {
                const response = await fetch(url, {
                    signal: controller.signal
                });
                clearTimeout(timeoutId);
                return response;
            } catch (error) {
                clearTimeout(timeoutId);
                if (error.name === 'AbortError') {
                    throw new Error('Request timeout');
                }
                throw error;
            }
        }

        function getWeatherEmoji(weather) {
            const weatherMap = {
                'clear': 'â˜€ï¸',
                'clouds': 'â›…',
                'rain': 'ğŸŒ§',
                'snow': 'â„ï¸',
                'thunderstorm': 'â›ˆ',
                'drizzle': 'ğŸŒ¦',
                'mist': 'ğŸŒ«',
                'fog': 'ğŸŒ«'
            };
            return weatherMap[weather.toLowerCase()] || 'ğŸŒ¤';
        }

        function formatDate(timestamp) {
            const date = new Date(timestamp * 1000);
            const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            return `${days[date.getDay()]}, ${months[date.getMonth()]} ${date.getDate()}`;
        }

        function getOutfitTip(temp, lang) {
            const t = translations[lang].outfitTips;
            if (temp < 10) return t.cold;
            if (temp < 20) return t.mild;
            return t.warm;
        }

        // ä¿å­˜æœ€è¿‘ä½¿ç”¨çš„åŸå¸‚
        function saveRecentCity(city, lang) {
            const recentCities = JSON.parse(localStorage.getItem('recentCities') || '{}');
            recentCities[lang] = city;
            localStorage.setItem('recentCities', JSON.stringify(recentCities));
        }

        // åˆå§‹åŒ–é¡µé¢
        function initializePage() {
            // æ¸²æŸ“å›½å®¶åˆ—è¡¨
            renderCountryList(currentLang);
        }

        // æ·»åŠ æœç´¢è¿‡æ»¤åŠŸèƒ½
        function filterList(input, listId) {
            const filter = input.value.toLowerCase();
            const list = document.querySelector(`#${listId} .nav-items`);
            const items = list.getElementsByClassName('nav-item');
            
            for (let item of items) {
                const text = item.textContent || item.innerText;
                if (text.toLowerCase().indexOf(filter) > -1) {
                    item.style.display = "";
                } else {
                    item.style.display = "none";
                }
            }
        }

        // æ›´æ–°æ¸²æŸ“å›½å®¶åˆ—è¡¨å‡½æ•°
        function renderCountryList(lang) {
            const countryList = document.getElementById('country-list');
            if (!countryList) return;

            const itemsContainer = countryList.querySelector('.nav-items');
            if (!itemsContainer) return;

            // æ¸…é™¤ä¹‹å‰çš„äº‹ä»¶ç›‘å¬
            const newItemsContainer = itemsContainer.cloneNode(true);
            itemsContainer.parentNode.replaceChild(newItemsContainer, itemsContainer);
            
            newItemsContainer.innerHTML = popularCountries[lang]
                .map(country => `
                    <div class="nav-item" data-code="${country.code}">
                        ${country.name}
                </div>
                `).join('');

            // æ·»åŠ å›½å®¶é€‰æ‹©äº‹ä»¶ç›‘å¬
            newItemsContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('nav-item')) {
                    selectCountry(e.target.dataset.code, e.target.textContent, lang);
                }
            });
        }

        // æ›´æ–°é€‰æ‹©å›½å®¶å‡½æ•°
        async function selectCountry(countryCode, countryName, lang) {
            try {
                currentSelection[lang].country = { code: countryCode, name: countryName };
                
                // æ›´æ–°æ˜¾ç¤ºçš„å€¼
                const countryTitle = document.getElementById('country-title');
                const selectedValue = countryTitle.querySelector('.selected-value') || document.createElement('div');
                selectedValue.className = 'selected-value';
                selectedValue.textContent = countryName;
                if (!countryTitle.querySelector('.selected-value')) {
                    countryTitle.appendChild(selectedValue);
                }

                // éšè—å›½å®¶åˆ—è¡¨
                const countryList = document.getElementById('country-list');
                countryList.classList.remove('show');
                countryTitle.classList.remove('active');
                
                // ä½¿ç”¨é¢„è®¾çš„çƒ­é—¨åŸå¸‚æ•°æ®
                if (popularCities[countryCode]) {
                    renderCityList(popularCities[countryCode][lang], lang);
                    // è‡ªåŠ¨å±•å¼€åŸå¸‚åˆ—è¡¨
                    const cityList = document.getElementById('city-list');
                    const cityTitle = document.getElementById('city-title');
                    cityList.classList.add('show');
                    cityTitle.classList.add('active');
                } else {
                    showError(translations[lang].cityNotFound);
                }
            } catch (error) {
                console.error('Error loading cities:', error);
                showError(translations[lang].networkError);
            }
        }

        // æ›´æ–°æ¸²æŸ“åŸå¸‚åˆ—è¡¨å‡½æ•°
        function renderCityList(cities, lang) {
            const cityList = document.getElementById('city-list');
            if (!cityList) return;

            const itemsContainer = cityList.querySelector('.nav-items');
            if (!itemsContainer) return;

            // æ¸…é™¤ä¹‹å‰çš„äº‹ä»¶ç›‘å¬
            const newItemsContainer = itemsContainer.cloneNode(true);
            itemsContainer.parentNode.replaceChild(newItemsContainer, itemsContainer);
            
            newItemsContainer.innerHTML = cities
                .map(city => `
                    <div class="nav-item" data-lat="${city.latitude}" data-lon="${city.longitude}">
                        ${city.name}
                    </div>
                `).join('');
            
            // æ·»åŠ åŸå¸‚é€‰æ‹©äº‹ä»¶ç›‘å¬
            newItemsContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('nav-item')) {
                    selectCity(e.target.dataset.lat, e.target.dataset.lon, e.target.textContent, lang);
                }
            });
        }

        // æ›´æ–°é€‰æ‹©åŸå¸‚å‡½æ•°
        function selectCity(lat, lon, cityName, lang) {
            currentSelection[lang].city = { lat, lon, name: cityName };
            
            // æ›´æ–°æ˜¾ç¤ºçš„å€¼
            const cityTitle = document.getElementById('city-title');
            const selectedValue = cityTitle.querySelector('.selected-value') || document.createElement('div');
            selectedValue.className = 'selected-value';
            selectedValue.textContent = cityName;
            if (!cityTitle.querySelector('.selected-value')) {
                cityTitle.appendChild(selectedValue);
            }

            // éšè—åŸå¸‚åˆ—è¡¨
            const cityList = document.getElementById('city-list');
            cityList.classList.remove('show');
            cityTitle.classList.remove('active');
            
            // ç”Ÿæˆæœªæ¥7å¤©çš„æ—¥æœŸåˆ—è¡¨
            const dates = generateDateList(lang);
            renderDateList(dates, lang);
            
            // è‡ªåŠ¨å±•å¼€æ—¥æœŸåˆ—è¡¨
            const dateList = document.getElementById('date-list');
            const dateTitle = document.getElementById('date-title');
            dateList.classList.add('show');
            dateTitle.classList.add('active');
            
            // è·å–å¤©æ°”æ•°æ®
            getWeatherData(lat, lon, lang);
        }

        // å½“å‰é€‰æ‹©çš„æ—¥æœŸçŠ¶æ€
        let currentDate = new Date();
        let selectedDate = new Date();

        // ç”Ÿæˆæ—¥æœŸåˆ—è¡¨æ”¹ä¸ºç”Ÿæˆæ—¥å†
        function generateDateList(lang) {
            const today = new Date();
            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
            
            // è·å–è¿™ä¸ªæœˆç¬¬ä¸€å¤©æ˜¯æ˜ŸæœŸå‡ ï¼ˆ0-6ï¼‰
            const firstDayOfWeek = firstDay.getDay();
            
            // è®¡ç®—æ—¥å†ç½‘æ ¼éœ€è¦æ˜¾ç¤ºçš„å¤©æ•°ï¼ˆåŒ…æ‹¬ä¸Šä¸ªæœˆçš„æœ€åå‡ å¤©ï¼‰
            const totalDays = firstDayOfWeek + lastDay.getDate();
            const totalWeeks = Math.ceil(totalDays / 7);
            
            const weekDays = lang === 'zh' 
                ? ['æ—¥', 'ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­']
                : ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            
            const monthNames = lang === 'zh'
                ? ['ä¸€æœˆ', 'äºŒæœˆ', 'ä¸‰æœˆ', 'å››æœˆ', 'äº”æœˆ', 'å…­æœˆ', 'ä¸ƒæœˆ', 'å…«æœˆ', 'ä¹æœˆ', 'åæœˆ', 'åä¸€æœˆ', 'åäºŒæœˆ']
                : ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];

            return {
                weekDays,
                monthName: monthNames[currentDate.getMonth()],
                year: currentDate.getFullYear(),
                totalWeeks,
                firstDayOfWeek: firstDayOfWeek,
                lastDate: lastDay.getDate(),
                today: today,
                selectedDate: selectedDate
            };
        }

        // æ¸²æŸ“æ—¥å†
        function renderDateList(dates, lang) {
            const dateList = document.getElementById('date-list');
            if (!dateList) return;

            const calendarData = generateDateList(lang);
            
            let html = `
                <div class="calendar-wrapper">
                    <div class="calendar-header">
                        <div class="calendar-title">
                            ${calendarData.monthName} ${calendarData.year}
                        </div>
                        <div class="calendar-nav">
                            <button onclick="changeMonth(-1)">â€¹</button>
                            <button onclick="changeMonth(1)">â€º</button>
                        </div>
                    </div>
                    <div class="calendar-grid">
            `;

            // æ·»åŠ æ˜ŸæœŸæ ‡é¢˜
            calendarData.weekDays.forEach(day => {
                html += `<div class="calendar-weekday">${day}</div>`;
            });

            // è®¡ç®—æ—¥æœŸèŒƒå›´ï¼ˆæœªæ¥7å¤©ï¼‰
            const today = new Date();
            const maxSelectableDate = new Date();
            maxSelectableDate.setDate(today.getDate() + 6);

            let currentDay = 1;
            let currentWeek = 0;

            while (currentWeek < calendarData.totalWeeks) {
                for (let i = 0; i < 7; i++) {
                    if ((currentWeek === 0 && i < calendarData.firstDayOfWeek) || 
                        currentDay > calendarData.lastDate) {
                        html += '<div class="calendar-day disabled"></div>';
                    } else {
                        const date = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDay);
                        const isToday = date.toDateString() === today.toDateString();
                        const isSelected = date.toDateString() === selectedDate.toDateString();
                        const isInRange = date >= today && date <= maxSelectableDate;
                        const hasWeather = isInRange;

                        const classes = [
                            'calendar-day',
                            isToday ? 'today' : '',
                            isSelected ? 'active' : '',
                            hasWeather ? 'has-weather' : '',
                            !isInRange ? 'disabled' : ''
                        ].filter(Boolean).join(' ');

                        html += `
                            <div class="${classes}" 
                                 onclick="${isInRange ? `selectDate(${date.getDate() - today.getDate()}, '${formatDate(date.getTime() / 1000)}', '${lang}')` : ''}"
                            >${currentDay}</div>
                        `;
                        currentDay++;
                    }
                }
                currentWeek++;
            }

            html += '</div></div>';
            dateList.innerHTML = html;
        }

        // åˆ‡æ¢æœˆä»½
        function changeMonth(delta) {
            currentDate.setMonth(currentDate.getMonth() + delta);
            renderDateList(null, currentLang);
        }

        // ä¿®æ”¹é€‰æ‹©æ—¥æœŸå‡½æ•°
        function selectDate(dateIndex, dateText, lang) {
            // æ›´æ–°é€‰ä¸­çš„æ—¥æœŸ
            selectedDate = new Date(Date.parse(dateText));
            
            // æ›´æ–°æ˜¾ç¤º
            renderDateList(null, lang);
            
            const { city } = currentSelection[lang];
            if (!city) return;
            
            // ä½¿ç”¨å·²æœ‰çš„å¤©æ°”æ•°æ®æ›´æ–°æ˜¾ç¤º
            const weatherContainer = document.getElementById('weather-info');
            if (weatherContainer && weatherContainer._weatherData) {
                const weatherData = weatherContainer._weatherData;
                // æ›´æ–°å¤©æ°”ä¿¡æ¯å’Œç©¿æ­å»ºè®®
                showWeatherInfo(weatherData, dateIndex, lang);
                generateOutfitRecommendations(weatherData, dateIndex, lang);
            } else {
                // å¦‚æœæ²¡æœ‰ç¼“å­˜çš„å¤©æ°”æ•°æ®ï¼Œé‡æ–°è·å–
                getWeatherData(city.lat, city.lon, lang);
            }
        }

        // æ›´æ–°å¯¼èˆªçŠ¶æ€
        function updateNavigation(lang) {
            const selection = currentSelection[lang];
            
            // æ›´æ–°é€‰ä¸­çŠ¶æ€
            const countryList = document.getElementById('country-list');
            const cityList = document.getElementById('city-list');
            const dateList = document.getElementById('date-list');

            if (countryList) {
                countryList.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.toggle('active', item.dataset.code === selection.country?.code);
                });
            }
            
            if (cityList) {
                cityList.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.toggle('active', item.textContent === selection.city?.name);
                });
            }
            
            if (dateList) {
                dateList.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.toggle('active', item.dataset.index === selection.date?.index?.toString());
                });
            }
        }

        // æ·»åŠ ç¼“å­˜ç®¡ç†
        const WeatherCache = {
            data: new Map(),
            maxAge: 15 * 60 * 1000, // 15åˆ†é’Ÿç¼“å­˜

            getKey(lat, lon) {
                return `${lat},${lon}`;
            },

            set(lat, lon, data) {
                const key = this.getKey(lat, lon);
                this.data.set(key, {
                    timestamp: Date.now(),
                    data: data
                });
            },

            get(lat, lon) {
                const key = this.getKey(lat, lon);
                const cached = this.data.get(key);
                
                if (!cached) return null;
                
                // æ£€æŸ¥ç¼“å­˜æ˜¯å¦è¿‡æœŸ
                if (Date.now() - cached.timestamp > this.maxAge) {
                    this.data.delete(key);
                    return null;
                }
                
                return cached.data;
            },

            clear() {
                this.data.clear();
            }
        };

        // ä¼˜åŒ–æ˜¾ç¤ºå¤©æ°”ä¿¡æ¯å‡½æ•°
        function showWeatherInfo(weatherData, dateIndex, lang) {
            // ä¿å­˜å¤©æ°”æ•°æ®åˆ°å®¹å™¨ä¸­
            const weatherContainer = document.getElementById('weather-info');
            if (weatherContainer) {
                weatherContainer._weatherData = weatherData;
            }

            // æ›´æ–°å½“å‰å¤©æ°”æ˜¾ç¤º
            updateCurrentWeather(weatherData, lang);
            
            // æ¸²æŸ“å¤©æ°”é¢„æŠ¥å¡ç‰‡
            renderForecastCards(weatherData, dateIndex, lang);
            
            // ç”Ÿæˆç©¿æ­å»ºè®®
            generateOutfitRecommendations(weatherData, dateIndex, lang);
            
            // æ›´æ–°é¡µé¢æ ‡é¢˜
            updatePageTitle(weatherData, lang);
        }

        // åˆ†ç¦»å½“å‰å¤©æ°”æ›´æ–°é€»è¾‘
        function updateCurrentWeather(weatherData, lang) {
            const currentWeatherContainer = document.getElementById('current-weather');
            if (!currentWeatherContainer || !weatherData.current) return;

            const { temp, feels_like, humidity, wind_speed, weather_code, last_update } = weatherData.current;
            const weatherCondition = getWeatherCondition(weather_code);
            
            // æ ¼å¼åŒ–å¤©æ°”æ•°æ®ï¼Œç¡®ä¿æœ‰é»˜è®¤å€¼
            const formattedTemp = temp !== undefined && temp !== null ? `${Math.round(temp)}Â°C` : '--Â°C';
            const formattedWeather = translations[lang].weather[weatherCondition] || '--';
            const formattedHumidity = humidity !== undefined && humidity !== null ? `${Math.round(humidity)}%` : '--%';
            const formattedWindSpeed = wind_speed !== undefined && wind_speed !== null ? `${Math.round(wind_speed)} m/s` : '-- m/s';
            const formattedLastUpdate = last_update || new Date().toLocaleTimeString(lang === 'zh' ? 'zh-CN' : 'en-US');
            
            currentWeatherContainer.innerHTML = `
                <div class="current-temp">${formattedTemp}</div>
                <div class="current-details">
                    ${formattedWeather}
                    <br>
                    ${translations[lang].humidity || 'æ¹¿åº¦'}: ${formattedHumidity}
                    <br>
                    ${translations[lang].windSpeed || 'é£é€Ÿ'}: ${formattedWindSpeed}
                    <br>
                </div>
                <div class="last-update">
                    ${translations[lang].lastUpdate || 'æœ€åæ›´æ–°'}: ${formattedLastUpdate}
            </div>
        `;
    }

        // ä¼˜åŒ–å¤©æ°”é¢„æŠ¥å¡ç‰‡æ¸²æŸ“
        let currentCardIndex = 0;

        function renderForecastCards(weatherData, selectedIndex, lang) {
            const container = document.getElementById('forecast-container');
            if (!container || !weatherData || !weatherData.daily) return;

            // åˆ›å»ºå¯¼èˆªæŒ‰é’®å’Œæ»šåŠ¨å®¹å™¨
            container.innerHTML = `
                <button class="nav-arrow prev" onclick="scrollForecast('prev')"></button>
                <button class="nav-arrow next" onclick="scrollForecast('next')"></button>
                <div class="forecast-scroll">
                    ${Array.from({ length: 7 }, (_, i) => {
                        const date = new Date();
                        date.setDate(date.getDate() + i);
                        
                        // ç¡®ä¿æ•°æ®å­˜åœ¨å¹¶è¿›è¡Œæ•°å€¼æ£€æŸ¥
                        const dayTemp_max = weatherData.daily.temperature_2m_max[i] !== undefined ? Math.round(weatherData.daily.temperature_2m_max[i]) : '--';
                        const dayTemp_min = weatherData.daily.temperature_2m_min[i] !== undefined ? Math.round(weatherData.daily.temperature_2m_min[i]) : '--';
                        const dayWeather_code = weatherData.daily.weather_code[i] || 0;
                        const dayPrecip_prob = weatherData.daily.precipitation_probability_max[i] !== undefined ? Math.round(weatherData.daily.precipitation_probability_max[i]) : '--';
                        const dayWind_speed = weatherData.daily.wind_speed_10m_max[i] !== undefined ? Math.round(weatherData.daily.wind_speed_10m_max[i]) : '--';
                        
                        const isActive = i === selectedIndex;
                        
                        return `
                            <div class="forecast-card${isActive ? ' active' : ''}" 
                                onclick="selectDate(${i}, '${formatDate(date.getTime() / 1000)}', '${lang}')">
                                <div class="forecast-date">${formatDate(date.getTime() / 1000)}</div>
                                <div class="forecast-weather">
                                    ${getWeatherEmoji(getWeatherCondition(dayWeather_code))}
                                </div>
                                <div class="forecast-temp">
                                    ${Math.round(dayTemp_min)}Â° ~ ${Math.round(dayTemp_max)}Â°
                                </div>
                                <div class="forecast-details">
                                    ${translations[lang].weather[getWeatherCondition(dayWeather_code)]}
                                    <br>
                                    ğŸ’§ ${Math.round(dayPrecip_prob)}% | ğŸ’¨ ${Math.round(dayWind_speed)}m/s
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;

            // æ›´æ–°å¯¼èˆªæŒ‰é’®çŠ¶æ€
            updateNavArrows();

            // å¦‚æœé€‰ä¸­çš„æ—¥æœŸä¸åœ¨å¯è§èŒƒå›´å†…ï¼Œæ»šåŠ¨åˆ°ç›¸åº”ä½ç½®
            if (selectedIndex >= 4) {
                currentCardIndex = selectedIndex - 3;
                scrollToCurrentIndex();
            }
        }

        function scrollForecast(direction) {
            const maxIndex = 3; // å¯æ»šåŠ¨çš„æœ€å¤§ç´¢å¼•å€¼ï¼Œç¡®ä¿æœ€åä¸€å¼ å¡ç‰‡å¯è§
            
            if (direction === 'prev') {
                currentCardIndex = Math.max(0, currentCardIndex - 1);
            } else {
                currentCardIndex = Math.min(maxIndex, currentCardIndex + 1);
            }
            
            scrollToCurrentIndex();
            updateNavArrows();
        }

        function scrollToCurrentIndex() {
            const scrollContainer = document.querySelector('.forecast-scroll');
            if (scrollContainer) {
                const scrollPercentage = (currentCardIndex * 25); // æ¯æ¬¡æ»šåŠ¨25%
                scrollContainer.style.transform = `translateX(-${scrollPercentage}%)`;
            }
        }

        function updateNavArrows() {
            const prevButton = document.querySelector('.nav-arrow.prev');
            const nextButton = document.querySelector('.nav-arrow.next');
            
            if (prevButton) {
                prevButton.classList.toggle('disabled', currentCardIndex === 0);
            }
            
            if (nextButton) {
                nextButton.classList.toggle('disabled', currentCardIndex === 3);
            }
        }

        // åˆ†ç¦»é¡µé¢æ ‡é¢˜æ›´æ–°é€»è¾‘
        function updatePageTitle(weatherData, lang) {
            const cityName = currentSelection[lang].city.name;
            document.title = `${cityName} ${Math.round(weatherData.current.temp)}Â°C | ${lang === 'zh' ? 'æ—…è¡Œç©¿æ­åŠ©æ‰‹' : 'Travel Outfit Advisor'}`;
        }

        // ç”Ÿæˆç©¿æ­å»ºè®®
        function generateOutfit(temp, weather, lang) {
            const t = translations[lang].outfits;
            let outfit = '';

            // åŸºäºæ¸©åº¦çš„åŸºç¡€ç©¿æ­å»ºè®®
        if (temp < 10) {
                outfit = t.cold;
        } else if (temp < 20) {
                outfit = t.mild;
        } else {
                outfit = t.warm;
            }

            // æ ¹æ®å¤©æ°”çŠ¶å†µæ·»åŠ é¢å¤–å»ºè®®
            if (weather === 'rain' || weather === 'drizzle' || weather === 'thunderstorm') {
                outfit += t.rainTip;
            } else if (weather === 'snow') {
                outfit += t.snowTip;
        }

        return outfit;
    }

        // ç”Ÿæˆç©¿æ­å»ºè®®
        function generateOutfitRecommendations(weatherData, dateIndex, lang) {
            const container = document.getElementById('outfit-recommendations');
            if (!container || !weatherData || !weatherData.daily) return;

            // è·å–å¤©æ°”æ•°æ®
            const temp = (weatherData.daily.temperature_2m_max[dateIndex] + weatherData.daily.temperature_2m_min[dateIndex]) / 2;
            const weather_code = weatherData.daily.weather_code[dateIndex];
            const weather = getWeatherCondition(weather_code);
            
            // ç”Ÿæˆä¸‰ç§ä¸åŒäººç¾¤çš„ç©¿æ­å»ºè®®
            const outfits = {
                women: generateOutfit(temp, weather, lang),
                men: generateOutfit(temp, weather, lang),
                kids: generateOutfit(temp, weather, lang)
            };

            // ä½¿ç”¨æ–°çš„å¸ƒå±€ç»“æ„ï¼Œä½†ä¿æŒåŸæœ‰çš„æ•°æ®ç”Ÿæˆé€»è¾‘
            const html = `
                <div class="outfit-card">
                    <h3>${lang === 'zh' ? 'ğŸ‘© å¥³å£«ç©¿æ­' : 'ğŸ‘© Women\'s Outfit'}</h3>
                    <div class="weather-icon">ğŸŒ¡ï¸ ${temp.toFixed(1)}Â°C</div>
                    <div class="outfit-content">${outfits.women}</div>
                </div>
                <div class="outfit-card">
                    <h3>${lang === 'zh' ? 'ğŸ‘¨ ç”·å£«ç©¿æ­' : 'ğŸ‘¨ Men\'s Outfit'}</h3>
                    <div class="weather-icon">ğŸŒ¡ï¸ ${temp.toFixed(1)}Â°C</div>
                    <div class="outfit-content">${outfits.men}</div>
                </div>
                <div class="outfit-card">
                    <h3>${lang === 'zh' ? 'ğŸ‘¶ å„¿ç«¥ç©¿æ­' : 'ğŸ‘¶ Kids\' Outfit'}</h3>
                    <div class="weather-icon">ğŸŒ¡ï¸ ${temp.toFixed(1)}Â°C</div>
                    <div class="outfit-content">${outfits.kids}</div>
                </div>
            `;

            container.innerHTML = html;
        }

        // æ›´æ–°å¤©æ°”ä»£ç è½¬æ¢å‡½æ•°
        function getWeatherCondition(code) {
            // WMO Weather interpretation codes (WW)
            if (code === 0) return 'clear';
            if (code >= 1 && code <= 3) return 'clouds';
            if (code >= 45 && code <= 48) return 'fog';
            if (code >= 51 && code <= 55) return 'drizzle';
            if (code >= 56 && code <= 57) return 'drizzle';
            if (code >= 61 && code <= 65) return 'rain';
            if (code >= 66 && code <= 67) return 'rain';
            if (code >= 71 && code <= 77) return 'snow';
            if (code >= 80 && code <= 82) return 'rain';
            if (code >= 85 && code <= 86) return 'snow';
            if (code >= 95 && code <= 99) return 'thunderstorm';
            return 'clear';
        }

        // æ·»åŠ è¯­è¨€åˆ‡æ¢å‡½æ•°
        function toggleLanguageList() {
            const btn = document.querySelector('.language-btn');
            const list = document.getElementById('languageList');
            const isShow = list.classList.contains('show');
            
            // åˆ‡æ¢æŒ‰é’®å’Œåˆ—è¡¨çš„çŠ¶æ€
            btn.classList.toggle('active');
            list.classList.toggle('show');

            // ç‚¹å‡»å¤–éƒ¨å…³é—­åˆ—è¡¨
            if (!isShow) {
                document.addEventListener('click', closeLanguageList);
            }
        }

        function closeLanguageList(e) {
            if (!e.target.closest('.language-switch')) {
                const btn = document.querySelector('.language-btn');
                const list = document.getElementById('languageList');
                btn.classList.remove('active');
                list.classList.remove('show');
                document.removeEventListener('click', closeLanguageList);
            }
        }

        function switchLanguage(lang) {
            const currentLangSpan = document.querySelector('.current-lang');
            const options = document.querySelectorAll('.language-option');
            const langNames = {
                'en': 'English',
                'zh': 'ç®€ä½“ä¸­æ–‡',
                'zh-TW': 'ç¹é«”ä¸­æ–‡',
                'ja': 'æ—¥æœ¬èª',
                'ko': 'í•œêµ­ì–´',
                'de': 'Deutsch',
                'fr': 'FranÃ§ais',
                'it': 'Italiano',
                'es': 'EspaÃ±ol',
                'pt': 'PortuguÃªs',
                'hi': 'à¤¹à¤¿à¤‚à¤¦à¥€'
            };

            // æ›´æ–°å½“å‰è¯­è¨€æ˜¾ç¤º
            currentLangSpan.textContent = langNames[lang];

            // æ›´æ–°é€‰ä¸­çŠ¶æ€
            options.forEach(option => {
                option.classList.toggle('selected', option.textContent === langNames[lang]);
            });

            // å…³é—­è¯­è¨€åˆ—è¡¨
            toggleLanguageList();

            // ä¿å­˜è¯­è¨€è®¾ç½®å¹¶æ›´æ–°ç•Œé¢
            localStorage.setItem('preferred_language', lang);
            currentLang = lang;
            
            // æ›´æ–°ç•Œé¢æ–‡æœ¬
            updateInterfaceText(lang);

            // å¦‚æœå·²ç»é€‰æ‹©äº†åŸå¸‚ï¼Œé‡æ–°è·å–å¤©æ°”æ•°æ®
            const currentCity = currentSelection[lang]?.city;
            if (currentCity) {
                getWeatherData(currentCity.lat, currentCity.lon, lang);
            }
        }

        function updateSelectedDateWeather(selectedDate) {
            const container = document.querySelector('.current-weather');
            if (!container || !weatherData) return;

            // è·å–é€‰ä¸­æ—¥æœŸçš„ç´¢å¼•
            const dateStr = selectedDate.toISOString().split('T')[0];
            const dailyIndex = weatherData.daily.time.findIndex(time => time === dateStr);
            
            if (dailyIndex === -1) return;

            // è·å–è¯¥æ—¥æœŸçš„å°æ—¶æ•°æ®èµ·å§‹ç´¢å¼•ï¼ˆæ¯å¤©24å°æ—¶ï¼‰
            const hourlyStartIndex = dailyIndex * 24;
            const currentHour = new Date().getHours();
            const hourlyIndex = hourlyStartIndex + currentHour;

            // æ›´æ–°å¤©æ°”æ•°æ®
            const weatherInfo = {
                temp: Math.round((weatherData.daily.temperature_2m_max[dailyIndex] + weatherData.daily.temperature_2m_min[dailyIndex]) / 2),
                max_temp: Math.round(weatherData.daily.temperature_2m_max[dailyIndex]),
                min_temp: Math.round(weatherData.daily.temperature_2m_min[dailyIndex]),
                humidity: weatherData.hourly.relative_humidity_2m[hourlyIndex] ?? '--',
                wind_speed: weatherData.daily.wind_speed_10m_max[dailyIndex] ?? '--',
                weather_code: weatherData.daily.weather_code[dailyIndex],
                last_update: selectedDate.toLocaleDateString(lang === 'zh' ? 'zh-CN' : 'en-US')
            };

            // æ›´æ–° DOM
            container.innerHTML = `
                <div class="temperature">${weatherInfo.temp}Â°C</div>
                <div class="weather-condition">${getWeatherDescription(weatherInfo.weather_code, lang)}</div>
                <div class="weather-range">${weatherInfo.min_temp}Â° ~ ${weatherInfo.max_temp}Â°</div>
                <div class="humidity">Humidity: ${weatherInfo.humidity}%</div>
                <div class="wind-speed">Wind Speed: ${weatherInfo.wind_speed} m/s</div>
                <div class="last-update">Date: ${weatherInfo.last_update}</div>
            `;
        }

        // ä¿®æ”¹æ—¥æœŸç‚¹å‡»äº‹ä»¶å¤„ç†å‡½æ•°
        function handleDateClick(event) {
            const dateElement = event.target.closest('.date');
            if (!dateElement) return;

            // ç§»é™¤ä¹‹å‰çš„é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.date.selected').forEach(el => el.classList.remove('selected'));
            
            // æ·»åŠ æ–°çš„é€‰ä¸­çŠ¶æ€
            dateElement.classList.add('selected');
            
            // è·å–é€‰ä¸­çš„æ—¥æœŸ
            const selectedDate = new Date(dateElement.dataset.date);
            
            // æ›´æ–°å¤©æ°”æ˜¾ç¤º
            updateSelectedDateWeather(selectedDate);
            
            // æ›´æ–°å¤©æ°”é¢„æŠ¥å¡ç‰‡
            renderForecastCards(selectedDate);
        }

        // ä¿®æ”¹åˆå§‹åŒ–å‡½æ•°
        async function initWeatherApp() {
            // ... existing code ...
            
            // åˆå§‹åŒ–æ—¶ä½¿ç”¨å½“å‰æ—¥æœŸ
            const today = new Date();
            updateSelectedDateWeather(today);
            
            // æ·»åŠ æ—¥æœŸç‚¹å‡»äº‹ä»¶ç›‘å¬
            const dateContainer = document.querySelector('.date-list');
            if (dateContainer) {
                dateContainer.addEventListener('click', handleDateClick);
            }
            
            // ... existing code ...
        }

        // ä½¿ç”¨ MutationObserver æ›¿ä»£åºŸå¼ƒçš„ DOM äº‹ä»¶
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                    mutation.addedNodes.forEach(node => {
                        if (node.nodeType === 1) { // å…ƒç´ èŠ‚ç‚¹
                            initializeNewElements(node);
                        }
                    });
                }
            });
        });

        // åˆå§‹åŒ–æ–°æ·»åŠ çš„å…ƒç´ 
        function initializeNewElements(element) {
            // ä¸ºæ–°æ·»åŠ çš„æ—¥æœŸå…ƒç´ æ·»åŠ äº‹ä»¶ç›‘å¬
            const dateElements = element.querySelectorAll('.date');
            dateElements.forEach(dateEl => {
                if (!dateEl.dataset.initialized) {
                    dateEl.dataset.initialized = 'true';
                    dateEl.addEventListener('click', handleDateClick);
                }
            });

            // ä¸ºæ–°æ·»åŠ çš„å¤©æ°”å¡ç‰‡æ·»åŠ äº‹ä»¶ç›‘å¬
            const forecastCards = element.querySelectorAll('.forecast-card');
            forecastCards.forEach(card => {
                if (!card.dataset.initialized) {
                    card.dataset.initialized = 'true';
                    card.addEventListener('click', handleForecastCardClick);
                }
            });
        }

        // åœ¨é¡µé¢åŠ è½½å®Œæˆåå¯åŠ¨è§‚å¯Ÿå™¨
        document.addEventListener('DOMContentLoaded', () => {
            // é…ç½®è§‚å¯Ÿå™¨
            const config = {
                childList: true,
                subtree: true
            };

            // å¼€å§‹è§‚å¯Ÿæ–‡æ¡£å˜åŒ–
            observer.observe(document.body, config);

            // åˆå§‹åŒ–ç°æœ‰å…ƒç´ 
            initializeNewElements(document.body);
        });

        // æ›´æ–°æ ‡é¢˜æ–‡æœ¬
        document.addEventListener('DOMContentLoaded', function() {
            // ... existing code ...
            
            // æ›´æ–°ä¸­æ–‡æ ‡é¢˜
            const translations = {
                zh: {
                    title: 'æœ€å¥½çš„å¤©æ°”ç©¿è¡£æŒ‡å—',
                    // ... other translations ...
                },
                en: {
                    title: 'Best Weather Dress Guide',
                    // ... other translations ...
                }
            };
            
            // ... rest of the code ...
        });

        // æ·»åŠ ç®€å•çš„æ»šåŠ¨åŠ¨ç”»JavaScript
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.querySelector('.testimonials-container');
            let isDown = false;
            let startX;
            let scrollLeft;

            container.addEventListener('mousedown', (e) => {
                isDown = true;
                container.style.cursor = 'grabbing';
                startX = e.pageX - container.offsetLeft;
                scrollLeft = container.scrollLeft;
            });

            container.addEventListener('mouseleave', () => {
                isDown = false;
                container.style.cursor = 'grab';
            });

            container.addEventListener('mouseup', () => {
                isDown = false;
                container.style.cursor = 'grab';
            });

            container.addEventListener('mousemove', (e) => {
                if (!isDown) return;
                e.preventDefault();
                const x = e.pageX - container.offsetLeft;
                const walk = (x - startX) * 2;
                container.scrollLeft = scrollLeft - walk;
            });
        });
    </script>
</body>
</html>